<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Working with time series | sits: Satellite Image Time Series Analysis on Earth Observation Data Cubes</title>
<meta name="author" content="Gilberto Camara">
<meta name="author" content="Rolf Simoes">
<meta name="author" content="Felipe Souza">
<meta name="author" content="Felipe Menino">
<meta name="author" content="Charlotte Pelletier">
<meta name="author" content="Pedro R. Andrade">
<meta name="author" content="Karine Ferreira">
<meta name="author" content="Gilberto Queiroz">
<meta name="description" content="Data structures for satellite time series  The sits package uses sets of time series data describing properties in spatiotemporal locations of interest. For land classification, these sets consist...">
<meta name="generator" content="bookdown 0.39 with bs4_book()">
<meta property="og:title" content="Working with time series | sits: Satellite Image Time Series Analysis on Earth Observation Data Cubes">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/cover_sits_book.png">
<meta property="og:description" content="Data structures for satellite time series  The sits package uses sets of time series data describing properties in spatiotemporal locations of interest. For land classification, these sets consist...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Working with time series | sits: Satellite Image Time Series Analysis on Earth Observation Data Cubes">
<meta name="twitter:description" content="Data structures for satellite time series  The sits package uses sets of time series data describing properties in spatiotemporal locations of interest. For land classification, these sets consist...">
<meta name="twitter:image" content="/images/cover_sits_book.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/IBM_Plex_Serif-0.4.9/font.css" rel="stylesheet">
<link href="libs/IBM_Plex_Mono-0.4.9/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title=""><strong>sits</strong>: Satellite Image Time Series Analysis on Earth Observation Data Cubes</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="setup.html">Setup</a></li>
<li><a class="" href="acknowledgements.html">Acknowledgements</a></li>
<li><a class="" href="introduction.html">Introduction</a></li>
<li><a class="" href="earth-observation-data-cubes.html">Earth observation data cubes</a></li>
<li><a class="" href="operations-on-data-cubes.html">Operations on data cubes</a></li>
<li><a class="active" href="working-with-time-series.html">Working with time series</a></li>
<li><a class="" href="improving-the-quality-of-training-samples.html">Improving the quality of training samples</a></li>
<li><a class="" href="machine-learning-for-data-cubes.html">Machine learning for data cubes</a></li>
<li><a class="" href="classification-of-raster-data-cubes.html">Classification of raster data cubes</a></li>
<li><a class="" href="bayesian-smoothing-for-post-processing.html">Bayesian smoothing for post-processing</a></li>
<li><a class="" href="validation-and-accuracy-measurements.html">Validation and accuracy measurements</a></li>
<li><a class="" href="uncertainty-and-active-learning.html">Uncertainty and active learning</a></li>
<li><a class="" href="ensemble-prediction-from-multiple-models.html">Ensemble prediction from multiple models</a></li>
<li><a class="" href="object-based-time-series-image-analysis.html">Object-based time series image analysis</a></li>
<li><a class="" href="technical-annex.html">Technical annex</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="working-with-time-series" class="section level1 unnumbered">
<h1>Working with time series<a class="anchor" aria-label="anchor" href="#working-with-time-series"><i class="fas fa-link"></i></a>
</h1>
<div id="data-structures-for-satellite-time-series" class="section level2 unnumbered">
<h2>Data structures for satellite time series<a class="anchor" aria-label="anchor" href="#data-structures-for-satellite-time-series"><i class="fas fa-link"></i></a>
</h2>
<p><a href="https://www.kaggle.com/esensing/working-with-time-series-in-sits" target="_blank"><img src="https://kaggle.com/static/images/open-in-kaggle.svg"></a></p>
<p>The <code>sits</code> package uses sets of time series data describing properties in spatiotemporal locations of interest. For land classification, these sets consist of samples labeled by experts. The package can also be used for any type of classification, provided that the timeline and bands of the time series used for training match that of the data cubes.</p>
<p>In <code>sits</code>, time series are stored in a <code>tibble</code> data structure. The following code shows the first three lines of a time series tibble containing 1,882 labeled samples of land classes in Mato Grosso state of Brazil. The samples have time series extracted from the MODIS MOD13Q1 product from 2000 to 2016, provided every 16 days at 250 m resolution in the Sinusoidal projection. Based on ground surveys and high-resolution imagery, it includes samples of seven classes: <code>Forest</code>, <code>Cerrado</code>, <code>Pasture</code>, <code>Soy_Fallow</code>, <code>Soy_Cotton</code>, <code>Soy_Corn</code>, and <code>Soy_Millet</code>.</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Samples</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"samples_matogrosso_mod13q1"</span><span class="op">)</span></span>
<span><span class="va">samples_matogrosso_mod13q1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="op">]</span></span></code></pre></div>
<pre><code>#&gt; # A tibble: 4 × 7
#&gt;   longitude latitude start_date end_date   label   cube     time_series      
#&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;date&gt;     &lt;date&gt;     &lt;chr&gt;   &lt;chr&gt;    &lt;list&gt;           
#&gt; 1     -57.8    -9.76 2006-09-14 2007-08-29 Pasture bdc_cube &lt;tibble [23 × 5]&gt;
#&gt; 2     -59.4    -9.31 2014-09-14 2015-08-29 Pasture bdc_cube &lt;tibble [23 × 5]&gt;
#&gt; 3     -59.4    -9.31 2013-09-14 2014-08-29 Pasture bdc_cube &lt;tibble [23 × 5]&gt;
#&gt; 4     -57.8    -9.76 2006-09-14 2007-08-29 Pasture bdc_cube &lt;tibble [23 × 5]&gt;</code></pre>
<p>The time series tibble contains data and metadata. The first six columns contain spatial and temporal information, the label assigned to the sample, and the data cube from where the data has been extracted. The first sample has been labeled <code>Pasture</code> at location (-58.5631, -13.8844), being valid for the period (2006-09-14, 2007-08-29). Informing the dates where the label is valid is crucial for correct classification. In this case, the researchers labeling the samples used the agricultural calendar in Brazil. The relevant dates for other applications and other countries will likely differ from those used in the example. The <code>time_series</code> column contains the time series data for each spatiotemporal location. This data is also organized as a tibble, with a column with the dates and the other columns with the values for each spectral band.</p>
</div>
<div id="utilities-for-handling-time-series" class="section level2 unnumbered">
<h2>Utilities for handling time series<a class="anchor" aria-label="anchor" href="#utilities-for-handling-time-series"><i class="fas fa-link"></i></a>
</h2>
<p>The package provides functions for data manipulation and displaying information for time series tibbles. For example, <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> shows the labels of the sample set and their frequencies.</p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">samples_matogrosso_mod13q1</span><span class="op">)</span></span></code></pre></div>
<pre><code>#&gt; # A tibble: 7 × 3
#&gt;   label      count   prop
#&gt;   &lt;chr&gt;      &lt;int&gt;  &lt;dbl&gt;
#&gt; 1 Cerrado      379 0.206 
#&gt; 2 Forest       131 0.0713
#&gt; 3 Pasture      344 0.187 
#&gt; 4 Soy_Corn     364 0.198 
#&gt; 5 Soy_Cotton   352 0.192 
#&gt; 6 Soy_Fallow    87 0.0474
#&gt; 7 Soy_Millet   180 0.0980</code></pre>
<p>In many cases, it is helpful to relabel the dataset. For example, there may be situations where using a smaller set of labels is desirable because samples in one label on the original set may not be distinguishable from samples with other labels. We then could use <code>sits_labels()&lt;-</code> to assign new labels. The example below shows how to do relabeling on a time series set shown above; all samples associated with crops are grouped in a single <code>Croplands</code> label.</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Copy the sample set for Mato Grosso</span></span>
<span><span class="va">samples_new_labels</span> <span class="op">&lt;-</span> <span class="va">samples_matogrosso_mod13q1</span></span>
<span><span class="co"># Show the current labels</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_labels.html">sits_labels</a></span><span class="op">(</span><span class="va">samples_new_labels</span><span class="op">)</span></span></code></pre></div>
<pre><code>#&gt; [1] "Cerrado"    "Forest"     "Pasture"    "Soy_Corn"   "Soy_Cotton"
#&gt; [6] "Soy_Fallow" "Soy_Millet"</code></pre>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Update the labels</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_labels.html">sits_labels</a></span><span class="op">(</span><span class="va">samples_new_labels</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Cerrado"</span>, <span class="st">"Forest"</span>,</span>
<span>  <span class="st">"Pasture"</span>, <span class="st">"Croplands"</span>,</span>
<span>  <span class="st">"Cropland"</span>, <span class="st">"Cropland"</span>,</span>
<span>  <span class="st">"Cropland"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">samples_new_labels</span><span class="op">)</span></span></code></pre></div>
<pre><code>#&gt; # A tibble: 5 × 3
#&gt;   label     count   prop
#&gt;   &lt;chr&gt;     &lt;int&gt;  &lt;dbl&gt;
#&gt; 1 Cerrado     379 0.206 
#&gt; 2 Cropland    619 0.337 
#&gt; 3 Croplands   364 0.198 
#&gt; 4 Forest      131 0.0713
#&gt; 5 Pasture     344 0.187</code></pre>
<p>Since metadata and the embedded time series use the tibble data format, the functions from <code>dplyr</code>, <code>tidyr</code>, and <code>purrr</code> packages of the <code>tidyverse</code> <span class="citation"><a href="references.html#ref-Wickham2017">[23]</a></span> can be used to process the data. For example, the following code uses <code><a href="https://rdrr.io/pkg/sits/man/sits_select.html">sits_select()</a></code> to get a subset of the sample dataset with two bands (NDVI and EVI) and then uses the <code><a href="https://dplyr.tidyverse.org/reference/filter.html">dplyr::filter()</a></code> to select the samples labeled as <code>Cerrado</code>.</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select NDVI band</span></span>
<span><span class="va">samples_ndvi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_select.html">sits_select</a></span><span class="op">(</span><span class="va">samples_matogrosso_mod13q1</span>,</span>
<span>  bands <span class="op">=</span> <span class="st">"NDVI"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Select only samples with Cerrado label</span></span>
<span><span class="va">samples_cerrado</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>  <span class="va">samples_ndvi</span>,</span>
<span>  <span class="va">label</span> <span class="op">==</span> <span class="st">"Cerrado"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div id="time-series-visualisation" class="section level2 unnumbered">
<h2>Time series visualisation<a class="anchor" aria-label="anchor" href="#time-series-visualisation"><i class="fas fa-link"></i></a>
</h2>
<p>Given a few samples to display, <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> tries to group as many spatial locations together. In the following example, the first 12 samples labeled as <code>Cerrado</code> refer to the same spatial location in consecutive time periods. For this reason, these samples are plotted together.</p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the first 12 samples</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">samples_cerrado</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:cerrado-12"></span>
<img src="06-timeseries_files/figure-html/cerrado-12-1.png" alt="Plot of the first 'Cerrado' samples (source: authors)." width="70%"><p class="caption">
Figure 39: Plot of the first ‘Cerrado’ samples (source: authors).
</p>
</div>
<p>For many samples, the default visualization combines all samples together in a single temporal interval, even if they belong to different years. This plot shows the spread of values for the time series of each band. The strong red line in the plot indicates the median of the values, while the two orange lines are the first and third interquartile ranges. See <code><a href="https://rdrr.io/pkg/sits/man/plot.html">?sits::plot</a></code> for more details on data visualization in <code>sits</code>.</p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot all cerrado samples together</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">samples_cerrado</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="06-timeseries_files/figure-html/unnamed-chunk-6-1.png" alt="Plot of all Cerrado samples (source: authors)." width="70%"><p class="caption">
Figure 36: Plot of all Cerrado samples (source: authors).
</p>
</div>
<p>To see the spatial distribution of the samples, use <code><a href="https://rdrr.io/pkg/sits/man/sits_view.html">sits_view()</a></code> to create an interactive plot. The spatial visulisation is useful to show where the data has been collected.</p>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_view.html">sits_view</a></span><span class="op">(</span><span class="va">samples_matogrosso_mod13q1</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="images/view_samples.png" width="90%" style="display: block; margin: auto;"></div>
</div>
<div id="visualizing-sample-patterns" class="section level2 unnumbered">
<h2>Visualizing sample patterns<a class="anchor" aria-label="anchor" href="#visualizing-sample-patterns"><i class="fas fa-link"></i></a>
</h2>
<p>When dealing with large time series, its is useful to obtain a single plot that captures the essential temporal variability of each class. Following the work on the <code>dtwSat</code> R package <span class="citation"><a href="references.html#ref-Maus2019">[24]</a></span>, we use a generalized additive model (GAM) to obtain a single time series based on statistical approximation. In a GAM, the predictor depends linearly on a smooth function of the predictor variables.</p>
<p><span class="math display">\[
y = \beta_{i} + f(x) + \epsilon, \epsilon \sim N(0, \sigma^2).
\]</span></p>
<p>The function <code><a href="https://rdrr.io/pkg/sits/man/sits_patterns.html">sits_patterns()</a></code> uses a GAM to predict an idealized approximation to the time series associated with each class for all bands. The resulting patterns can be viewed using <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>.</p>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate the patterns for each class and plot them</span></span>
<span><span class="va">samples_matogrosso_mod13q1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_patterns.html">sits_patterns</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-9"></span>
<img src="06-timeseries_files/figure-html/unnamed-chunk-9-1.png" alt="Patterns for the samples for Mato Grosso (source: authors)." width="100%"><p class="caption">
Figure 16: Patterns for the samples for Mato Grosso (source: authors).
</p>
</div>
<p>The resulting patterns provide some insights over the time series behaviour of each class. The response of the Forest class is quite distinctive. They also show that it should be possible to separate between the single and double cropping classes. There are similarities between the double-cropping classes (<code>Soy_Corn</code> and <code>Soy_Millet</code>) and between the <code>Cerrado</code> and <code>Pasture</code> classes. The subtle differences between class signatures provide hints at possible ways by which machine learning algorithms might distinguish between classes. One example is the difference between the middle-infrared response during the dry season (May to September) to differentiate between <code>Cerrado</code> and <code>Pasture</code>.</p>
</div>
<div id="geographical-variability-of-training-samples" class="section level2 unnumbered">
<h2>Geographical variability of training samples<a class="anchor" aria-label="anchor" href="#geographical-variability-of-training-samples"><i class="fas fa-link"></i></a>
</h2>
<p>When working with machine learning classification of Earth observation data, it is important to evaluate if the training samples are well distributed in the study area. Training data often comes from ground surveys made at chosen locations. In large areas, ideally representative samples need to capture spatial variability. In practice, however, ground surveys or other means of data collection are limited to selected areas. In many cases, the geographical distribution of the training data does not cover the study area equally. Such mismatch can be a problem for achieving a good quality classification. As stated by Meyer and Pebesma <span class="citation"><a href="references.html#ref-Meyer2022">[25]</a></span>: “large gaps in geographic space do not always imply large gaps in feature space”.</p>
<p>Meyer and Pebesma propose using a spatial distance distribution plot, which displays two distributions of nearest-neighbor distances: sample-to-sample and prediction-location-to-sample <span class="citation"><a href="references.html#ref-Meyer2022">[25]</a></span>. The difference between the two distributions reflects the degree of spatial clustering in the reference data. Ideally, the two distributions should be similar. Cases where the sample-to-sample distance distribution does not match prediction-location-to-sample distribution indicate possible problems in training data collection.</p>
<p><code>sits</code> implements spatial distance distribution plots with the <code><a href="https://rdrr.io/pkg/sits/man/sits_geo_dist.html">sits_geo_dist()</a></code> function. This function gets a training data in the <code>samples</code> parameter, and the study area in the <code>roi</code> parameter expressed as an <code>sf</code> object. Additional parameters are <code>n</code> (maximum number of samples for each distribution) and <code>crs</code> (coordinate reference system for the samples). By default, <code>n</code> is 1000, and <code>crs</code> is “EPSG:4326”. The example below shows how to use <code><a href="https://rdrr.io/pkg/sits/man/sits_geo_dist.html">sits_geo_dist()</a></code>.</p>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read a shapefile for the state of Mato Grosso, Brazil</span></span>
<span><span class="va">mt_shp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/shapefiles/mato_grosso/mt.shp"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"sits"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Convert to an sf object</span></span>
<span><span class="va">mt_sf</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">read_sf</a></span><span class="op">(</span><span class="va">mt_shp</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate sample-to-sample and sample-to-prediction distances</span></span>
<span><span class="va">distances</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_geo_dist.html">sits_geo_dist</a></span><span class="op">(</span></span>
<span>  samples <span class="op">=</span> <span class="va">samples_modis_ndvi</span>,</span>
<span>  roi <span class="op">=</span> <span class="va">mt_sf</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Plot sample-to-sample and sample-to-prediction distances</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">distances</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-10"></span>
<img src="06-timeseries_files/figure-html/unnamed-chunk-10-1.png" alt="Distribution of sample-to-sample and sample-to-prediction distances (source: authors)." width="100%"><p class="caption">
Figure 5: Distribution of sample-to-sample and sample-to-prediction distances (source: authors).
</p>
</div>
<p>The plot shows a mismatch between the sample-to-sample and the sample-to-prediction distributions. Most samples are closer to each other than they are close to the location where values need to be predicted. In this case, there are many areas where few or no samples have been collected and where the prediction uncertainty will be higher. In this and similar cases, improving the distribution of training samples is always welcome. If that is not possible, areas with insufficient samples could have lower accuracy. This information must be reported to potential users of classification results.</p>
</div>
<div id="obtaining-time-series-data-from-data-cubes" class="section level2 unnumbered">
<h2>Obtaining time series data from data cubes<a class="anchor" aria-label="anchor" href="#obtaining-time-series-data-from-data-cubes"><i class="fas fa-link"></i></a>
</h2>
<p>To get a set of time series in <code>sits</code>, first create a regular data cube and then request one or more time series from the cube using <code><a href="https://rdrr.io/pkg/sits/man/sits_get_data.html">sits_get_data()</a></code>. This function uses two mandatory parameters: <code>cube</code> and <code>samples</code>. The <code>cube</code> indicates the data cube from which the time series will be extracted. The <code>samples</code> parameter accepts the following data types:</p>
<ul>
<li>A data.frame with information on <code>latitude</code> and <code>longitude</code> (mandatory), <code>start_date</code>, <code>end_date</code>, and <code>label</code> for each sample point.</li>
<li>A csv file with columns <code>latitude</code>, <code>longitude</code>, <code>start_date</code>, <code>end_date</code>, and <code>label</code>.</li>
<li>A shapefile containing either <code>POINT</code>or <code>POLYGON</code> geometries. See details below.</li>
<li>An <code>sf</code> object (from the <code>sf</code> package) with <code>POINT</code> or <code>POLYGON</code> geometry information. See details below.</li>
</ul>
<p>In the example below, given a data cube, the user provides the latitude and longitude of the desired location. Since the bands, start date, and end date of the time series are missing, <code>sits</code> obtains them from the data cube. The result is a tibble with one time series that can be visualized using <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>.</p>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtain a raster cube based on local files</span></span>
<span><span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/sinop"</span>, package <span class="op">=</span> <span class="st">"sitsdata"</span><span class="op">)</span></span>
<span><span class="va">raster_cube</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_cube.html">sits_cube</a></span><span class="op">(</span></span>
<span>  source     <span class="op">=</span> <span class="st">"BDC"</span>,</span>
<span>  collection <span class="op">=</span> <span class="st">"MOD13Q1-6.1"</span>,</span>
<span>  data_dir   <span class="op">=</span> <span class="va">data_dir</span>,</span>
<span>  parse_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"satellite"</span>, <span class="st">"sensor"</span>, <span class="st">"tile"</span>, <span class="st">"band"</span>, <span class="st">"date"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Obtain a time series from the raster cube from a point</span></span>
<span><span class="va">sample_latlong</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  longitude <span class="op">=</span> <span class="op">-</span><span class="fl">55.57320</span>,</span>
<span>  latitude  <span class="op">=</span> <span class="op">-</span><span class="fl">11.50566</span></span>
<span><span class="op">)</span></span>
<span><span class="va">series</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_get_data.html">sits_get_data</a></span><span class="op">(</span></span>
<span>  cube <span class="op">=</span> <span class="va">raster_cube</span>,</span>
<span>  samples <span class="op">=</span> <span class="va">sample_latlong</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">series</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-11"></span>
<img src="06-timeseries_files/figure-html/unnamed-chunk-11-1.png" alt="NDVI and EVI time series fetched from local raster cube (source: authors)." width="90%"><p class="caption">
Figure 6: NDVI and EVI time series fetched from local raster cube (source: authors).
</p>
</div>
<p>A useful case is when a set of labeled samples can be used as a training dataset. In this case, trusted observations are usually labeled and commonly stored in plain text files in comma-separated values (csv) or using shapefiles (shp).</p>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve a list of samples described by a csv file</span></span>
<span><span class="va">samples_csv_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/samples/samples_sinop_crop.csv"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"sits"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Read the csv file into an R object</span></span>
<span><span class="va">samples_csv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="va">samples_csv_file</span><span class="op">)</span></span>
<span><span class="co"># Print the first three samples</span></span>
<span><span class="va">samples_csv</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span></span></code></pre></div>
<pre><code>#&gt; # A tibble: 3 × 6
#&gt;      id longitude latitude start_date end_date   label  
#&gt;   &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;  
#&gt; 1     1     -55.7    -11.8 2013-09-14 2014-08-29 Pasture
#&gt; 2     2     -55.6    -11.8 2013-09-14 2014-08-29 Pasture
#&gt; 3     3     -55.7    -11.8 2013-09-14 2014-08-29 Forest</code></pre>
<p>To retrieve training samples for time series analysis, users must provide the temporal information (<code>start_date</code> and <code>end_date</code>). In the simplest case, all samples share the same dates. That is not a strict requirement. It is possible to specify different dates as long as they have a compatible duration. For example, the dataset <code>samples_matogrosso_mod13q1</code> provided with the <code>sitsdata</code> package contains samples from different years covering the same duration. These samples are from the MOD13Q1 product, which contains the same number of images per year. Thus, all time series in the dataset <code>samples_matogrosso_mod13q1</code> have the same number of dates.</p>
<p>Given a suitably built csv sample file, <code><a href="https://rdrr.io/pkg/sits/man/sits_get_data.html">sits_get_data()</a></code> requires two parameters: (a) <code>cube</code>, the name of the R object that describes the data cube; (b) <code>samples</code>, the name of the CSV file.</p>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the points from a data cube in raster brick format</span></span>
<span><span class="va">points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_get_data.html">sits_get_data</a></span><span class="op">(</span></span>
<span>  cube <span class="op">=</span> <span class="va">raster_cube</span>,</span>
<span>  samples <span class="op">=</span> <span class="va">samples_csv_file</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Show the tibble with the first three points</span></span>
<span><span class="va">points</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span></span></code></pre></div>
<pre><code>#&gt; # A tibble: 3 × 7
#&gt;   longitude latitude start_date end_date   label    cube        time_series
#&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;date&gt;     &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;       &lt;list&gt;     
#&gt; 1     -55.8    -11.7 2013-09-14 2014-08-29 Cerrado  MOD13Q1-6.1 &lt;tibble&gt;   
#&gt; 2     -55.8    -11.7 2013-09-14 2014-08-29 Cerrado  MOD13Q1-6.1 &lt;tibble&gt;   
#&gt; 3     -55.7    -11.7 2013-09-14 2014-08-29 Soy_Corn MOD13Q1-6.1 &lt;tibble&gt;</code></pre>
<p>Users can also specify samples by providing shapefiles or <code>sf</code> objects containing <code>POINT</code> or <code>POLYGON</code> geometries. The geographical location is inferred from the geometries associated with the shapefile or <code>sf</code> object. For files containing points, the geographical location is obtained directly. For polygon geometries, the parameter <code>n_sam_pol</code> (defaults to 20) determines the number of samples to be extracted from each polygon. The temporal information can be provided explicitly by the user; if absent, it is inferred from the data cube. If label information is available in the shapefile or <code>sf</code> object, the parameter <code>label_attr</code> is compulsory to indicate which column contains the label associated with each time series.</p>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtain a set of points inside the state of Mato Grosso, Brazil</span></span>
<span><span class="va">shp_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/shapefiles/mato_grosso/mt.shp"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"sits"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Read the shapefile into an "sf" object</span></span>
<span><span class="va">sf_shape</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="va">shp_file</span><span class="op">)</span></span></code></pre></div>
<pre><code>#&gt; Reading layer `mt' from data source 
#&gt;   `/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/sits/extdata/shapefiles/mato_grosso/mt.shp' 
#&gt;   using driver `ESRI Shapefile'
#&gt; Simple feature collection with 1 feature and 3 fields
#&gt; Geometry type: MULTIPOLYGON
#&gt; Dimension:     XY
#&gt; Bounding box:  xmin: -61.63284 ymin: -18.03993 xmax: -50.22481 ymax: -7.349034
#&gt; Geodetic CRS:  SIRGAS 2000</code></pre>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a data cube based on MOD13Q1 collection from BDC</span></span>
<span><span class="va">modis_cube</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_cube.html">sits_cube</a></span><span class="op">(</span></span>
<span>  source      <span class="op">=</span> <span class="st">"BDC"</span>,</span>
<span>  collection  <span class="op">=</span> <span class="st">"MOD13Q1-6.1"</span>,</span>
<span>  bands       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NDVI"</span>, <span class="st">"EVI"</span><span class="op">)</span>,</span>
<span>  roi         <span class="op">=</span> <span class="va">sf_shape</span>,</span>
<span>  start_date  <span class="op">=</span> <span class="st">"2020-06-01"</span>,</span>
<span>  end_date    <span class="op">=</span> <span class="st">"2021-08-29"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read the points from the cube and produce a tibble with time series</span></span>
<span><span class="va">samples_mt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_get_data.html">sits_get_data</a></span><span class="op">(</span></span>
<span>  cube         <span class="op">=</span> <span class="va">modis_cube</span>,</span>
<span>  samples      <span class="op">=</span> <span class="va">shp_file</span>,</span>
<span>  start_date   <span class="op">=</span> <span class="st">"2020-06-01"</span>,</span>
<span>  end_date     <span class="op">=</span> <span class="st">"2021-08-29"</span>,</span>
<span>  n_sam_pol    <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  multicores   <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div id="filtering-time-series" class="section level2 unnumbered">
<h2>Filtering time series<a class="anchor" aria-label="anchor" href="#filtering-time-series"><i class="fas fa-link"></i></a>
</h2>
<p>Satellite image time series is generally contaminated by atmospheric influence, geolocation error, and directional effects <span class="citation"><a href="references.html#ref-Lambin2006">[26]</a></span>. Atmospheric noise, sun angle, interferences on observations or different equipment specifications, and the nature of the climate-land dynamics can be sources of variability <span class="citation"><a href="references.html#ref-Atkinson2012">[27]</a></span>. Inter-annual climate variability also changes the phenological cycles of the vegetation, resulting in time series whose periods and intensities do not match on a year-to-year basis. To make the best use of available satellite data archives, methods for satellite image time series analysis need to deal with <em>noisy</em> and <em>non-homogeneous</em> datasets.</p>
<p>The literature on satellite image time series has several applications of filtering to correct or smooth vegetation index data. The package supports the well-known Savitzky–Golay (<code><a href="https://rdrr.io/pkg/sits/man/sits_sgolay.html">sits_sgolay()</a></code>) and Whittaker (<code><a href="https://rdrr.io/pkg/sits/man/sits_whittaker.html">sits_whittaker()</a></code>) filters. In an evaluation of NDVI time series filtering for estimating phenological parameters in India, Atkinson et al. found that the Whittaker filter provides good results <span class="citation"><a href="references.html#ref-Atkinson2012">[27]</a></span>. Zhou et al. found that the Savitzky-Golay filter is suitable for reconstructing tropical evergreen broadleaf forests <span class="citation"><a href="references.html#ref-Zhou2016">[28]</a></span>.</p>
<div id="savitzkygolay-filter" class="section level3 unnumbered">
<h3>Savitzky–Golay filter<a class="anchor" aria-label="anchor" href="#savitzkygolay-filter"><i class="fas fa-link"></i></a>
</h3>
<p>The Savitzky-Golay filter fits a successive array of <span class="math inline">\(2n+1\)</span> adjacent data points with a <span class="math inline">\(d\)</span>-degree polynomial through linear least squares. The main parameters for the filter are the polynomial degree (<span class="math inline">\(d\)</span>) and the length of the window data points (<span class="math inline">\(n\)</span>). It generally produces smoother results for a larger value of <span class="math inline">\(n\)</span> and/or a smaller value of <span class="math inline">\(d\)</span> <span class="citation"><a href="references.html#ref-Chen2004">[29]</a></span>. The optimal value for these two parameters can vary from case to case. In <code>sits</code>, the parameter <code>order</code> sets the order of the polynomial (default = 3), the parameter <code>length</code> sets the size of the temporal window (default = 5), and the parameter <code>scaling</code> sets the temporal expansion (default = 1). The following example shows the effect of Savitsky-Golay filter on a point extracted from the MOD13Q1 product, ranging from 2000-02-18 to 2018-01-01.</p>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Take NDVI band of the first sample dataset</span></span>
<span><span class="va">point_ndvi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_select.html">sits_select</a></span><span class="op">(</span><span class="va">point_mt_6bands</span>, band <span class="op">=</span> <span class="st">"NDVI"</span><span class="op">)</span></span>
<span><span class="co"># Apply Savitzky Golay filter</span></span>
<span><span class="va">point_sg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_sgolay.html">sits_sgolay</a></span><span class="op">(</span><span class="va">point_ndvi</span>, length <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span>
<span><span class="co"># Merge the point and plot the series</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_merge.html">sits_merge</a></span><span class="op">(</span><span class="va">point_sg</span>, <span class="va">point_ndvi</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-16"></span>
<img src="06-timeseries_files/figure-html/unnamed-chunk-16-1.png" alt="Savitzky-Golay filter applied on a multi-year NDVI time series (source: authors)." width="90%"><p class="caption">
Figure 17: Savitzky-Golay filter applied on a multi-year NDVI time series (source: authors).
</p>
</div>
<p>The resulting smoothed curve has both desirable and unwanted properties. From 2000 to 2008, the Savitsky-Golay filter removes noise from clouds. However, after 2010, when the region was converted to agriculture, the filter removes an important part of the natural variability from the crop cycle. Therefore, the <code>length</code> parameter is arguably too big, resulting in oversmoothing.</p>
</div>
<div id="whittaker-filter" class="section level3 unnumbered">
<h3>Whittaker filter<a class="anchor" aria-label="anchor" href="#whittaker-filter"><i class="fas fa-link"></i></a>
</h3>
<p>The Whittaker smoother attempts to fit a curve representing the raw data, but is penalized if subsequent points vary too much <span class="citation"><a href="references.html#ref-Atzberger2011">[30]</a></span>. The Whittaker filter balances the residual to the original data and the smoothness of the fitted curve. The filter has one parameter: <span class="math inline">\(\lambda{}\)</span> that works as a smoothing weight parameter. The following example shows the effect of the Whittaker filter on a point extracted from the MOD13Q1 product, ranging from 2000-02-18 to 2018-01-01. The <code>lambda</code> parameter controls the smoothing of the filter. By default, it is set to 0.5, a small value. The example shows the effect of a larger smoothing parameter.</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Take NDVI band of the first sample dataset</span></span>
<span><span class="va">point_ndvi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_select.html">sits_select</a></span><span class="op">(</span><span class="va">point_mt_6bands</span>, band <span class="op">=</span> <span class="st">"NDVI"</span><span class="op">)</span></span>
<span><span class="co"># Apply Whitakker filter</span></span>
<span><span class="va">point_whit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_whittaker.html">sits_whittaker</a></span><span class="op">(</span><span class="va">point_ndvi</span>, lambda <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co"># Merge the point and plot the series</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_merge.html">sits_merge</a></span><span class="op">(</span><span class="va">point_whit</span>, <span class="va">point_ndvi</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-17"></span>
<img src="06-timeseries_files/figure-html/unnamed-chunk-17-1.png" alt="Whittaker filter applied on a one-year NDVI time series (source: authors)." width="90%"><p class="caption">
Figure 40: Whittaker filter applied on a one-year NDVI time series (source: authors).
</p>
</div>
<p>Similar to what is observed in the Savitsky-Golay filter, high values of the smoothing parameter <code>lambda</code> produce an over-smoothed time series that reduces the capacity of the time series to represent natural variations in crop growth. For this reason, low smoothing values are recommended when using <code><a href="https://rdrr.io/pkg/sits/man/sits_whittaker.html">sits_whittaker()</a></code>.</p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="operations-on-data-cubes.html">Operations on data cubes</a></div>
<div class="next"><a href="improving-the-quality-of-training-samples.html">Improving the quality of training samples</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#working-with-time-series">Working with time series</a></li>
<li><a class="nav-link" href="#data-structures-for-satellite-time-series">Data structures for satellite time series</a></li>
<li><a class="nav-link" href="#utilities-for-handling-time-series">Utilities for handling time series</a></li>
<li><a class="nav-link" href="#time-series-visualisation">Time series visualisation</a></li>
<li><a class="nav-link" href="#visualizing-sample-patterns">Visualizing sample patterns</a></li>
<li><a class="nav-link" href="#geographical-variability-of-training-samples">Geographical variability of training samples</a></li>
<li><a class="nav-link" href="#obtaining-time-series-data-from-data-cubes">Obtaining time series data from data cubes</a></li>
<li>
<a class="nav-link" href="#filtering-time-series">Filtering time series</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#savitzkygolay-filter">Savitzky–Golay filter</a></li>
<li><a class="nav-link" href="#whittaker-filter">Whittaker filter</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong><strong>sits</strong>: Satellite Image Time Series Analysis on Earth Observation Data Cubes</strong>" was written by Gilberto Camara, Rolf Simoes, Felipe Souza, Felipe Menino, Charlotte Pelletier, Pedro R. Andrade, Karine Ferreira, Gilberto Queiroz. It was last built on 2024-08-08.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
