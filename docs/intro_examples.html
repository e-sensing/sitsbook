<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Gilberto Camara, Rolf Simoes, Felipe Souza, Felipe Carlos, Pedro Andrade, Karine Ferreira, Lorena Santos and Charlotte Pelletier">
<title>Satellite Image Time Series Analysis on Earth Observation Data Cubes - 2&nbsp; How to use SITS with real examples</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./intro_visualisation.html" rel="next">
<link href="./intro_quicktour.html" rel="prev">
<link href="././images/cover_sits_book_quarto.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./introduction.html">The Basics of SITS</a></li><li class="breadcrumb-item"><a href="./intro_examples.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">How to use SITS with real examples</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Satellite Image Time Series Analysis on Earth Observation Data Cubes</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/e-sensing/sitsbook" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Greetings</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setup</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./acknowledgements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgements</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Basics of SITS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_quicktour.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">A quick tour of SITS</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_examples.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">How to use SITS with real examples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_visualisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data visualisation in SITS</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./datacubes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Earth observation data cubes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dc_ardcollections.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Analysis-ready image collections</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dc_regularize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Building regular data cubes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dc_merge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Merging multi-source EO data cubes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dc_localcubes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data cubes from local files</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dc_cubeoperations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Computing NDVI and other spectral indices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dc_mixture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Spectral mixture analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dc_reduce.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Temporal reduction operations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dc_texture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Texture operations in data cubes</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./timeseries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Satellite image time series</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ts_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Basic operations on image time series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ts_cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Hierarchical clustering of time series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ts_som.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Self-organized maps for sample quality control</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ts_balance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Reducing imbalances in training samples</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine learning for image time series</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cl_machinelearning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Machine learning algorithms for image time series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cl_tuning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Deep learning model tuning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cl_rasterclassification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Classification of raster data cubes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cl_smoothing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Bayesian smoothing for classification post-processing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cl_reclassification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Map reclassification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cl_uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Uncertainty and active learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cl_ensembleprediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Ensemble prediction with multiple models</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./validation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Validation and accuracy measurement</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./val_kfold.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Cross-validation of training data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./val_map.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Map accuracy assessment</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./vector_datacubes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vector data cubes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vec_obia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Object-based time series image analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vec_creating.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Creating vector data cube from local files</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./annex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./annex_export.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Exporting data to other packages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./annex_gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">SITS and GEE: side-by-side comparison</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./annex_api.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Developing new functions in SITS</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./annex_ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Including new methods for machine learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./annex_stac.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Supporting STAC-based ARD catalogs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./annex_parallel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">How parallel processing works in SITS</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#configuration-to-run-the-examples-in-this-chapter" id="toc-configuration-to-run-the-examples-in-this-chapter" class="nav-link active" data-scroll-target="#configuration-to-run-the-examples-in-this-chapter">Configuration to run the examples in this chapter</a></li>
  <li>
<a href="#classifying-deforestation-in-rondonia" id="toc-classifying-deforestation-in-rondonia" class="nav-link" data-scroll-target="#classifying-deforestation-in-rondonia"><span class="header-section-number">2.1</span> Classifying deforestation in Rondonia</a>
  <ul class="collapse">
<li><a href="#deforestation-samples-in-the-brazilian-amazon" id="toc-deforestation-samples-in-the-brazilian-amazon" class="nav-link" data-scroll-target="#deforestation-samples-in-the-brazilian-amazon"><span class="header-section-number">2.1.1</span> Deforestation samples in the Brazilian Amazon</a></li>
  <li><a href="#build-data-cube-and-visualize-band-combination" id="toc-build-data-cube-and-visualize-band-combination" class="nav-link" data-scroll-target="#build-data-cube-and-visualize-band-combination"><span class="header-section-number">2.1.2</span> Build Data Cube and visualize band combination</a></li>
  <li><a href="#training-a-machine-learning-model" id="toc-training-a-machine-learning-model" class="nav-link" data-scroll-target="#training-a-machine-learning-model"><span class="header-section-number">2.1.3</span> Training a Machine Learning model</a></li>
  <li><a href="#data-cube-classification" id="toc-data-cube-classification" class="nav-link" data-scroll-target="#data-cube-classification"><span class="header-section-number">2.1.4</span> Data cube classification</a></li>
  </ul>
</li>
  <li>
<a href="#land-use-and-land-cover-map-for-brazilian-cerrado" id="toc-land-use-and-land-cover-map-for-brazilian-cerrado" class="nav-link" data-scroll-target="#land-use-and-land-cover-map-for-brazilian-cerrado"><span class="header-section-number">2.2</span> Land Use and Land cover Map for Brazilian Cerrado</a>
  <ul class="collapse">
<li><a href="#cerrado-samples" id="toc-cerrado-samples" class="nav-link" data-scroll-target="#cerrado-samples"><span class="header-section-number">2.2.1</span> Cerrado samples</a></li>
  <li><a href="#acessing-landsat-images" id="toc-acessing-landsat-images" class="nav-link" data-scroll-target="#acessing-landsat-images"><span class="header-section-number">2.2.2</span> Acessing Landsat images</a></li>
  <li><a href="#computing-vegetation-indices" id="toc-computing-vegetation-indices" class="nav-link" data-scroll-target="#computing-vegetation-indices"><span class="header-section-number">2.2.3</span> Computing vegetation indices</a></li>
  <li><a href="#getting-time-series" id="toc-getting-time-series" class="nav-link" data-scroll-target="#getting-time-series"><span class="header-section-number">2.2.4</span> Getting time series</a></li>
  <li><a href="#training-a-deep-learning-model" id="toc-training-a-deep-learning-model" class="nav-link" data-scroll-target="#training-a-deep-learning-model"><span class="header-section-number">2.2.5</span> Training a Deep Learning model</a></li>
  <li><a href="#training-a-deep-learning-model-1" id="toc-training-a-deep-learning-model-1" class="nav-link" data-scroll-target="#training-a-deep-learning-model-1"><span class="header-section-number">2.2.6</span> Training a deep learning model</a></li>
  <li><a href="#data-cube-classification-1" id="toc-data-cube-classification-1" class="nav-link" data-scroll-target="#data-cube-classification-1"><span class="header-section-number">2.2.7</span> Data cube classification</a></li>
  <li><a href="#accuracy-assessment-of-classified-images" id="toc-accuracy-assessment-of-classified-images" class="nav-link" data-scroll-target="#accuracy-assessment-of-classified-images"><span class="header-section-number">2.2.8</span> Accuracy assessment of classified images</a></li>
  </ul>
</li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">3</span> Conclusion</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/e-sensing/sitsbook/edit/quarto/intro_examples.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/e-sensing/sitsbook/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">2</span>&nbsp; <span class="chapter-title">How to use SITS with real examples</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>The following scripts show examples of how to use <code>sits</code> for land classification. The first is a classification of a Sentinel-2 tile in Rondonia (Brasil) to detect deforestation and the second a land use and land cover classification of area in the Cerrado biome in Brazil.</p>
<section id="configuration-to-run-the-examples-in-this-chapter" class="level3 unnumbered"><h3 class="unnumbered anchored" data-anchor-id="configuration-to-run-the-examples-in-this-chapter">Configuration to run the examples in this chapter</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># load package "tibble"</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span></span>
<span><span class="co"># load packages "sits" and "sitsdata"</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/e-sensing/sits/">sits</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/e-sensing/sitsdata/">sitsdata</a></span><span class="op">)</span></span>
<span><span class="co"># set tempdir if it does not exist</span></span>
<span><span class="va">tempdir_r</span> <span class="op">&lt;-</span> <span class="st">"~/sitsbook/tempdir/R/intro_examples"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="va">tempdir_r</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># set tempdir for Cerrado if it does not exist</span></span>
<span><span class="va">tempdir_cerrado_cube</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">tempdir_r</span>, <span class="st">"/cerrado/cube"</span><span class="op">)</span></span>
<span><span class="va">tempdir_cerrado</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">tempdir_r</span>, <span class="st">"/cerrado"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="va">tempdir_cerrado</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="va">tempdir_cerrado_cube</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># set tempdir for Rondonia if it does not exist</span></span>
<span><span class="va">tempdir_rondonia</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">tempdir_r</span>, <span class="st">"/rondonia"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="va">tempdir_rondonia</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load "pysits" library</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pysits <span class="im">import</span> <span class="op">*</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set tempdir if it does not exist </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>tempdir_py <span class="op">=</span> Path.home() <span class="op">/</span> <span class="st">"sitsbook/tempdir/Python/intro_examples"</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>tempdir_rondonia <span class="op">=</span> tempdir_py <span class="op">/</span> <span class="st">"rondonia"</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>tempdir_rondonia.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>tempdir_cerrado <span class="op">=</span> tempdir_py <span class="op">/</span> <span class="st">"cerrado"</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>tempdir_cerrado_cube <span class="op">=</span> tempdir_cerrado <span class="op">/</span> <span class="st">"cube"</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>tempdir_cerrado_cube.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="classifying-deforestation-in-rondonia" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="classifying-deforestation-in-rondonia">
<span class="header-section-number">2.1</span> Classifying deforestation in Rondonia</h2>
<p>The Amazon rainforest has a global importance due to its vast biodiversity and the critical ecosystem services it provides. As one of the most biodiverse regions on Earth, it plays a central role in regulating the planet’s climate and ecological balance. Undisturbed natural forests absorb large amounts of carbon dioxide from the atmosphere, which is vital for mitigating climate change.</p>
<p>Our study area is the state of Rondônia (RO), located in the Brazilian Amazon. Deforestation in Rondonia is fragmented, in part due to the region’s historical occupation by smallholder settlers. This high degree of fragmentation presents significant challenges for automated classification methods, particularly in distinguishing between clear-cut areas and those that are highly degraded. While visual interpreters can rely on their experience and contextual field knowledge, automated approaches must be carefully trained to reach similar levels of accuracy and discernment.</p>
<section id="deforestation-samples-in-the-brazilian-amazon" class="level3" data-number="2.1.1"><h3 data-number="2.1.1" class="anchored" data-anchor-id="deforestation-samples-in-the-brazilian-amazon">
<span class="header-section-number">2.1.1</span> Deforestation samples in the Brazilian Amazon</h3>
<p>We used an event-based sample, where an “event” refers to a specific occurrence associated with changes in land cover. For example, deforestation is a process characterized by multiple sequential events. Initially, portions of the forest are removed through selective logging; subsequently, surface fires—often set by poachers—are used to degrade the remaining forest and facilitate the extraction of large trees <span class="citation" data-cites="Nepstad1999"><a href="#ref-Nepstad1999" role="doc-biblioref">[1]</a></span>. The process continues with the manual or mechanized removal of timber, potentially followed by additional fires to clear the area completely <span class="citation" data-cites="Gerwing2002"><a href="#ref-Gerwing2002" role="doc-biblioref">[2]</a></span>. These events were associated with distinct land cover classes to be detected through time series classification, allowing the model to recognize and differentiate between various stages and types of land cover change.</p>
<p>The <a href="https://github.com/e-sensing/rondonia20LMR"><code>rondonia20LMR</code></a> repository provides a dataset for testing machine learning algorithms applied to the mapping and monitoring of deforestation in the Brazilian Amazon. The dataset consists of a regular time series of Sentinel-2 satellite images covering the <code>MGRS 20LMR</code> tile, with 23 temporal instances from January 5 to December 23, 2022, at 16-day intervals. Each instance includes the spectral bands <code>B02</code>, <code>B03</code>, <code>B04</code>, <code>B05</code>, <code>B06</code>, <code>B07</code>, <code>B08</code>, <code>B8A</code>, <code>B11</code>, and <code>B12</code>. The samples contain time series for <code>792</code> selected locations, each assigned to one of the following classes: <code>Clear_Cut_Bare_Soil</code> (<code>944</code>), <code>Clear_Cut_Burned_Area</code> (<code>983</code>), <code>Clear_Cut_Vegetation</code> (<code>603</code>), <code>Forest</code> (<code>964</code>), <code>Mountainside_Forest</code> (<code>211</code>), <code>Riparian_Forest</code> (<code>1247</code>), <code>Seasonally_Flooded</code> (<code>731</code>), <code>Water</code> (<code>109</code>) and <code>Wetland</code> (<code>215</code>).</p>
<p>To access the data, it is needed to clone the <a href="https://github.com/e-sensing/rondonia20LMR"><code>rondonia20LMR</code></a> repository from the e-sensing GitHub repository into a local directory. To do this, open a terminal and execute the following commands:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/e-sensing/rondonia20LMR.git</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After cloning the repository, the local directory path can be used to proceed with the example. This path will serve as the reference location for accessing the dataset and continuing with the subsequent steps in the analysis workflow.</p>
<p>In the <code>rondonia20LMR</code> directory, the file <code>deforestation_samples_v18.rds</code> contains time series extracted from Sentinel-2 satellite images over tile <code>20LMR</code>. These data are automatically made available when the package is loaded. Each time series includes the following columns: <code>longitude</code>, <code>latitude</code>, <code>start date</code>, <code>end date</code>, <code>label</code>, <code>cube</code>, and <code>time series</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Samples path</span></span>
<span><span class="va">samples_path</span> <span class="op">&lt;-</span> <span class="st">"rondonia20LMR/inst/extdata/samples/deforestation_samples_v18.rds"</span></span>
<span></span>
<span><span class="co"># Read the Cerrado samples</span></span>
<span><span class="va">deforestation_samples_v18</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="va">samples_path</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Samples path</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>samples_path <span class="op">=</span> <span class="st">"rondonia20LMR/inst/extdata/samples/deforestation_samples_v18.rds"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the Cerrado samples</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>deforestation_samples_v18 <span class="op">=</span> read_rds(samples_path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>As shown in the previous example, the <code><a href="https://rdrr.io/pkg/sits/man/sits_patterns.html">sits_patterns()</a></code> function from the <code>sits</code> package allows the visualization of the temporal patterns of the classes. In the example below, we show these patterns for each class:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Generate the temporal patterns</span></span>
<span><span class="va">deforestation_samples_v18</span>  <span class="op">|&gt;</span> </span>
<span>     <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_select.html">sits_select</a></span><span class="op">(</span>bands <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"B02"</span>, <span class="st">"B8A"</span>, <span class="st">"B11"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>     <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_patterns.html">sits_patterns</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>     <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the temporal patterns</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>plot(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    sits_patterns(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>        sits_select(deforestation_samples_v18, bands <span class="op">=</span> (<span class="st">"B02"</span>, <span class="st">"B8A"</span>, <span class="st">"B11"</span>))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pattern-intro-rondonia" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/intro_examples_rondonia/intro_patterns_rondonia.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2.1: Temporal patterns for each class.</figcaption></figure>
</div>
</div>
</div>
<p>The plot shows the temporal patterns of the different classes throughout the period. The classes <code>Forest</code>, <code>Mountainside_Forest</code> and <code>Riparian_Forest</code> display high values in band <code>B8A</code> (<code>near-infrared</code>), indicating high photosynthetic activity throughout the year. This is a typical characteristic of dense and evergreen vegetation. In contrast, the classes <code>Clear_Cut_Bare_Soil</code> and <code>Clear_Cut_Burned_Area</code> exhibit lower values in band <code>B8A</code> and increasing values in band <code>B11</code> (<code>shortwave infrared</code>) during the second half of the year, suggesting exposed soil and possible presence of burned or degraded areas. The <code>Seasonally_Flooded</code> class shows seasonal variations in bands <code>B8A</code> and <code>B11</code>, possibly related to the hydrological dynamics of these areas. The <code>Water</code> class shows very low values across all analyzed bands, especially in <code>B8A</code> and <code>B11</code>, reflecting the strong absorption of water in these spectral regions. Finally, the <code>Wetland</code> class shows increasing values in bands <code>B8A</code> and <code>B11</code> over the course of the year, indicating a possible transition between periods of water saturation and greater vegetation presence.</p>
</section><section id="build-data-cube-and-visualize-band-combination" class="level3" data-number="2.1.2"><h3 data-number="2.1.2" class="anchored" data-anchor-id="build-data-cube-and-visualize-band-combination">
<span class="header-section-number">2.1.2</span> Build Data Cube and visualize band combination</h3>
<p>Let us access the Sentinel images available in the repository. First, it is necessary to define the provider, which in this case is the <code>Microsoft Planetary Computer</code> (MPC). Then, we specify the directory path, as shown below:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Images path</span></span>
<span><span class="va">images_path</span> <span class="op">&lt;-</span> <span class="st">"rondonia20LMR/inst/extdata/images/"</span></span>
<span></span>
<span><span class="co"># Access local data cube</span></span>
<span><span class="va">cube_20LMR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_cube.html">sits_cube</a></span><span class="op">(</span></span>
<span>     source <span class="op">=</span> <span class="st">"MPC"</span>,</span>
<span>     collection <span class="op">=</span> <span class="st">"SENTINEL-2-L2A"</span>,</span>
<span>     data_dir <span class="op">=</span> <span class="va">images_path</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Images path</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>images_path <span class="op">=</span> <span class="st">"rondonia20LMR/inst/extdata/images/"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Access local data cube</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>cube_20LMR <span class="op">=</span> sits_cube(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    source <span class="op">=</span> <span class="st">"MPC"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    collection <span class="op">=</span> <span class="st">"SENTINEL-2-L2A"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    data_dir <span class="op">=</span> images_path</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>The <code><a href="https://rdrr.io/pkg/sits/man/sits_cube.html">sits_cube()</a></code> function creates the data cube <code>cube_20LMR</code> with the Sentinel-2 tile <code>20LMR</code> images available in the repository. Each temporal instance includes the spectral bands <code>B02</code>, <code>B03</code>, <code>B04</code>, <code>B05</code>, <code>B06</code>, <code>B07</code>, <code>B08</code>, <code>B8A</code>, <code>B11</code> and <code>B12</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Plot one temporal instance</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cube_20LMR</span>, red <span class="op">=</span> <span class="st">"B11"</span>, green <span class="op">=</span> <span class="st">"B8A"</span>, blue <span class="op">=</span> <span class="st">"B02"</span>, date <span class="op">=</span> <span class="st">"2022-07-16"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot one temporal instance</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>plot(cube_20LMR, red <span class="op">=</span> <span class="st">"B11"</span>, green <span class="op">=</span> <span class="st">"B8A"</span>, blue <span class="op">=</span> <span class="st">"B02"</span>, date <span class="op">=</span> <span class="st">"2022-07-16"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pattern-intro-cube" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/intro_examples_rondonia/intro_cube_20LMR_rondonia.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2.2: Visualization of band composition in Rondonia.</figcaption></figure>
</div>
</div>
</div>
<p>SITS provides the <code><a href="https://rdrr.io/pkg/sits/man/sits_select.html">sits_select()</a></code> function, which filters only the selected bands and dates from a set of time series or a data cube. As shown in the code below:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Select only bands B02, B8A and B11</span></span>
<span><span class="va">samples_3bands</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_select.html">sits_select</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">deforestation_samples_v18</span>,</span>
<span>        bands <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"B02"</span>, <span class="st">"B8A"</span>, <span class="st">"B11"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only bands B02, B8A and B11</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>samples_3bands <span class="op">=</span> sits_select(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> deforestation_samples_v18,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    bands <span class="op">=</span> (<span class="st">"B02"</span>, <span class="st">"B8A"</span>, <span class="st">"B11"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="training-a-machine-learning-model" class="level3" data-number="2.1.3"><h3 data-number="2.1.3" class="anchored" data-anchor-id="training-a-machine-learning-model">
<span class="header-section-number">2.1.3</span> Training a Machine Learning model</h3>
<p>The next step in producing a classified map is to train a model. In the code below, we use the <code><a href="https://rdrr.io/pkg/sits/man/sits_train.html">sits_train()</a></code> function to train a Random Forest classifier with the samples containing the <code>B02</code>, <code>B8A</code> and <code>B11</code> bands:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Train the selected samples set using Rfor</span></span>
<span><span class="va">rfor_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_train.html">sits_train</a></span><span class="op">(</span></span>
<span>        samples <span class="op">=</span> <span class="va">samples_3bands</span>,</span>
<span>        ml_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_rfor.html">sits_rfor</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the selected samples set using Rfor</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>rfor_model <span class="op">=</span> sits_train(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    samples <span class="op">=</span> samples_3bands,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    ml_method <span class="op">=</span> sits_rfor()</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Random Forest is a classification algorithm based on multiple decision trees, each trained with random subsets of data and attributes. The final prediction is made by majority voting among the trees. This approach reduces overfitting and improves model accuracy. The method also provides the importance of each attribute, which can assist in feature selection. For more details on the use of Random Forest in time series classification of satellite images, see Pelletier et al., (2016) <span class="citation" data-cites="Pelletier2016"><a href="#ref-Pelletier2016" role="doc-biblioref">[3]</a></span>. For more, refer to <a href="./cl_machinelearning.html#random-forest">Random Forest</a> section.</p>
</section><section id="data-cube-classification" class="level3" data-number="2.1.4"><h3 data-number="2.1.4" class="anchored" data-anchor-id="data-cube-classification">
<span class="header-section-number">2.1.4</span> Data cube classification</h3>
<p>The next step in producing a classified map is to apply the trained model to the data cube. In the example below, we use the <code><a href="https://rdrr.io/pkg/sits/man/sits_classify.html">sits_classify()</a></code> function to classify the <code>cube_20LMR</code> cube using the Random Forest model. The <code><a href="https://rdrr.io/pkg/sits/man/sits_classify.html">sits_classify()</a></code> function creates one raster probability map per class, showing the model’s confidence for each pixel. It requires two main arguments: <code>data</code> (a data cube or time series) and <code>ml_model</code> (the trained model). Optional arguments include <code>multicores</code> (number of processing cores), <code>memsize</code> (available memory) and <code>output_dir</code> (output directory).</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Classify the data cube</span></span>
<span><span class="va">cube_20LMR_probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_classify.html">sits_classify</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">cube_20LMR</span>,</span>
<span>        ml_model <span class="op">=</span> <span class="va">rfor_model</span>,</span>
<span>        multicores <span class="op">=</span> <span class="fl">5</span>,</span>
<span>        memsize <span class="op">=</span> <span class="fl">8</span>,</span>
<span>        output_dir <span class="op">=</span> <span class="va">tempdir_rondonia</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the probabilities</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cube_20LMR_probs</span>, labels <span class="op">=</span> <span class="st">"Forest"</span>, palette <span class="op">=</span> <span class="st">"YlGn"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Classify the data cube</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>cube_20LMR_probs <span class="op">=</span> sits_classify(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> cube_20LMR,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    ml_model <span class="op">=</span> rfor_model,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    multicores <span class="op">=</span> <span class="dv">5</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    memsize <span class="op">=</span> <span class="dv">8</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    output_dir <span class="op">=</span> tempdir_rondonia</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the probabilities</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>plot(cube_20LMR_probs, labels <span class="op">=</span> <span class="st">"Forest"</span>, palette <span class="op">=</span> <span class="st">"YlGn"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-probs-intro-rondonia" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/intro_examples_rondonia/intro_cube_20LMR_probs_rondonia.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2.3: Visualization of forest probabilities in Rondonia.</figcaption></figure>
</div>
</div>
</div>
<p>After classification, the probability maps can be visualized, such as for the <code>Forest</code> class. These maps help assess classification uncertainty and can support active learning approaches, as discussed in the section on image classification in data cubes.</p>
<p>We recommend smoothing the results based on the spatial neighborhood of the pixels. This step helps incorporate spatial context and reduce isolated errors, especially in transition areas. The <code><a href="https://rdrr.io/pkg/sits/man/sits_smooth.html">sits_smooth()</a></code> function performs this task by applying a spatial Bayesian model to adjust predictions using neighboring class probabilities. In the code below, we apply smoothing to the classified cube <code>cube_20LMR_probs</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Smoothing the probabilities</span></span>
<span><span class="va">cube_20LMR_bayes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_smooth.html">sits_smooth</a></span><span class="op">(</span></span>
<span>        cube <span class="op">=</span> <span class="va">cube_20LMR_probs</span>,</span>
<span>        multicores <span class="op">=</span> <span class="fl">5</span>,</span>
<span>        memsize <span class="op">=</span> <span class="fl">8</span>,</span>
<span>        output_dir <span class="op">=</span> <span class="va">tempdir_rondonia</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the smoothed probabilities</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cube_20LMR_bayes</span>, labels <span class="op">=</span> <span class="st">"Forest"</span>, palette <span class="op">=</span> <span class="st">"YlGn"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Smoothing the probabilities</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>cube_20LMR_bayes <span class="op">=</span> sits_smooth(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    cube <span class="op">=</span> cube_20LMR_probs,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    multicores <span class="op">=</span> <span class="dv">5</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    memsize <span class="op">=</span> <span class="dv">8</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    output_dir <span class="op">=</span> tempdir_rondonia</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the smoothed probabilities</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>plot(cube_20LMR_bayes, labels <span class="op">=</span> <span class="st">"Forest"</span>, palette <span class="op">=</span> <span class="st">"YlGn"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-smooth-intro-rondonia" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/intro_examples_rondonia/intro_cube_20LMR_bayes_rondonia.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2.4: Visualization of forest smoothing in Rondonia.</figcaption></figure>
</div>
</div>
</div>
<p>We use the default values for <code>smoothness</code> and <code>window_size</code>, which generally yield good results. However, we recommend tuning these parameters based on the specific needs of your application. Smoothing reduces classification uncertainty by removing isolated low-confidence pixels. In the smoothed map for the <code>Forest</code> class, most outliers are corrected, resulting in a more spatially consistent classification.</p>
<p>The final step is to assign a class label to each pixel by selecting the one with the highest probability value. After spatial smoothing, we use the <code><a href="https://rdrr.io/pkg/sits/man/sits_label_classification.html">sits_label_classification()</a></code> function to generate the final classification map:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cube_20LMR_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_label_classification.html">sits_label_classification</a></span><span class="op">(</span></span>
<span>        cube <span class="op">=</span> <span class="va">cube_20LMR_bayes</span>,</span>
<span>        multicores <span class="op">=</span> <span class="fl">5</span>,</span>
<span>        memsize <span class="op">=</span> <span class="fl">8</span>,</span>
<span>        output_dir <span class="op">=</span> <span class="va">tempdir_rondonia</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the map</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cube_20LMR_map</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>cube_20LMR_map <span class="op">=</span> sits_label_classification(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    cube <span class="op">=</span> cube_20LMR_bayes,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    multicores <span class="op">=</span> <span class="dv">5</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    memsize <span class="op">=</span> <span class="dv">8</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    output_dir <span class="op">=</span> tempdir_rondonia</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the map</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>plot(cube_20LMR_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-label-classification-intro-rondonia" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/intro_examples_rondonia/intro_cube_20LMR_map_rondonia.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2.5: Visualization of classification map in Rondonia.</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="land-use-and-land-cover-map-for-brazilian-cerrado" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="land-use-and-land-cover-map-for-brazilian-cerrado">
<span class="header-section-number">2.2</span> Land Use and Land cover Map for Brazilian Cerrado</h2>
<p>The Cerrado is the second largest biome in Brazil, covering approximately 1.9 million <span class="math inline">\(km^2\)</span>. This tropical savanna ecoregion is characterized by a rich and diverse ecosystem that ranges from grasslands to woodlands. It is home to over 7,000 plant species, many of which are endemic <span class="citation" data-cites="Klink2005"><a href="#ref-Klink2005" role="doc-biblioref">[4]</a></span>. The biome comprises three major types of natural vegetation: Open Cerrado, predominantly composed of grasses and small shrubs with occasional small trees; Cerrado Sensu Stricto, a typical savanna formation characterized by low, thin-trunked trees with irregular branching; and Cerradão, a dry forest composed of medium-sized trees reaching up to 10–12 meters in height <span class="citation" data-cites="Goodland1971 Del-Claro2019"><a href="#ref-Goodland1971" role="doc-biblioref">[5]</a>, <a href="#ref-Del-Claro2019" role="doc-biblioref">[6]</a></span>. Despite its ecological importance, large portions of the Cerrado are being rapidly converted to agricultural land, making it one of the world’s most dynamic agricultural frontiers <span class="citation" data-cites="Walter2006"><a href="#ref-Walter2006" role="doc-biblioref">[7]</a></span>. The primary agricultural activities include cattle ranching, crop farming, and the establishment of planted forests.</p>
<p>In this example, we replicated the results presented in the article “Satellite Image Time Series Analysis for Big Earth Observation Data” <span class="citation" data-cites="Simoes2021"><a href="#ref-Simoes2021" role="doc-biblioref">[8]</a></span>, using Landsat imagery accessed through the Microsoft Planetary Computer (MPC) platform. We have selected a small region to illustrate all the steps involved in generating a land use and land cover map. The classification period ranges from September 2017 to August 2018, following the agricultural calendar. A temporal resolution of 16 days was used throughout the analysis.</p>
<section id="cerrado-samples" class="level3" data-number="2.2.1"><h3 data-number="2.2.1" class="anchored" data-anchor-id="cerrado-samples">
<span class="header-section-number">2.2.1</span> Cerrado samples</h3>
<p>Accurate classification requires a high-quality sample set. To obtain reliable training data, we conducted a systematic sampling using a 5 × 5 km grid across the entire Cerrado biome, resulting in the collection of 85,026 samples. The class labels for the training data were derived from three authoritative sources: the 2018 pastureland map provided by Pastagem.org <span class="citation" data-cites="Parente2019"><a href="#ref-Parente2019" role="doc-biblioref">[9]</a></span>, MapBiomas Collection 5 for the year 2018 <span class="citation" data-cites="Souza2020"><a href="#ref-Souza2020" role="doc-biblioref">[10]</a></span>, and land use maps from Brazil’s national mapping agency, IBGE, covering the period from 2016 to 2018 <span class="citation" data-cites="IBGE2020"><a href="#ref-IBGE2020" role="doc-biblioref">[11]</a></span>. From the initial set of 85,026 samples, we retained only those for which all three sources agreed on the assigned label. This filtering process resulted in a final dataset of 48,850 sample points. Time series data for these points were extracted from the Landsat-8 data cube. The distribution of samples by class is as follows: <code>Annual Crop</code> (6,887), <code>Cerradão</code> (4,211), <code>Cerrado</code> (16,251), <code>Natural Non-Vegetated</code> (38), <code>Open Cerrado</code> (5,658), <code>Pasture</code> (12,894), <code>Perennial Crop</code> (68), <code>Silviculture</code> (805), <code>Sugarcane</code> (1,775), and <code>Water</code> (263).</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Read the Cerrado samples</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"samples_cerrado_lc8_examples"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the Cerrado samples</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>samples_cerrado_lc8_examples <span class="op">=</span> load_samples_dataset(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    name    <span class="op">=</span> <span class="st">"samples_cerrado_lc8_examples"</span>, </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    package <span class="op">=</span> <span class="st">"sitsdata"</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>SITS package offers a range of functions to support a deeper understanding of the temporal behavior of sample data. One such function is <code><a href="https://rdrr.io/pkg/sits/man/sits_patterns.html">sits_patterns()</a></code>. In the example below, we showed the temporal patterns of each class.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Generate the temporal patterns</span></span>
<span><span class="va">samples_patterns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_patterns.html">sits_patterns</a></span><span class="op">(</span><span class="va">samples_cerrado_lc8_examples</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot samples patterns</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">samples_patterns</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the temporal patterns</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>samples_patterns <span class="op">=</span> sits_patterns(samples_cerrado_lc8_examples)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot samples patterns</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>plot(samples_patterns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pattern-intro-cerrado" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/patterns_intro_cerrado.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2.6: Temporal patterns of each class.</figcaption></figure>
</div>
</div>
</div>
<p>The plot presents the temporal patterns of the sample classes. The pattern observed for the <code>Annual Crop</code> class reflects the typical agricultural dynamics in cropping regions in Cerrado, characterized by the beginning of the season, followed by a maximum in vegetation vigor and then a senescence phase. This pattern repeats twice, indicating the presence of a double-cropping system. In contrast, the <code>Sugarcane</code> class exhibits a semi-perennial pattern. These distinct temporal behaviors can be derived through analysis of the pattern plot.</p>
</section><section id="acessing-landsat-images" class="level3" data-number="2.2.2"><h3 data-number="2.2.2" class="anchored" data-anchor-id="acessing-landsat-images">
<span class="header-section-number">2.2.2</span> Acessing Landsat images</h3>
<p>Let us start by accessing the Landsat collection through the Microsoft Planetary Computer provider. First, we need to define the region of interest (ROI) where the example will take place. This ROI is then used to select the tiles that intersect with it, as shown below:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Define a roi for the example</span></span>
<span><span class="va">roi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    lon_min <span class="op">=</span> <span class="op">-</span><span class="fl">50.780</span>,</span>
<span>    lat_min <span class="op">=</span> <span class="op">-</span><span class="fl">13.392</span>,</span>
<span>    lon_max <span class="op">=</span> <span class="op">-</span><span class="fl">50.540</span>,</span>
<span>    lat_max <span class="op">=</span> <span class="op">-</span><span class="fl">13.249</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Access the Landsat through the MPC</span></span>
<span><span class="va">mpc_cube</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_cube.html">sits_cube</a></span><span class="op">(</span></span>
<span>    source <span class="op">=</span> <span class="st">"MPC"</span>,</span>
<span>    collection  <span class="op">=</span> <span class="st">"LANDSAT-C2-L2"</span>,</span>
<span>    bands <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BLUE"</span>, <span class="st">"GREEN"</span>, <span class="st">"RED"</span>, <span class="st">"NIR08"</span>, <span class="st">"SWIR16"</span>, <span class="st">"SWIR22"</span>, <span class="st">"CLOUD"</span><span class="op">)</span>,</span>
<span>    roi <span class="op">=</span> <span class="va">roi</span>,</span>
<span>    start_date <span class="op">=</span> <span class="st">"2017-08-29"</span>,</span>
<span>    end_date <span class="op">=</span> <span class="st">"2018-08-29"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a roi for the example</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>roi <span class="op">=</span> <span class="bu">dict</span>(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    lon_min <span class="op">=</span> <span class="op">-</span><span class="fl">50.780</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    lat_min <span class="op">=</span> <span class="op">-</span><span class="fl">13.392</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    lon_max <span class="op">=</span> <span class="op">-</span><span class="fl">50.540</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    lat_max <span class="op">=</span> <span class="op">-</span><span class="fl">13.249</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Access the Landsat through the MPC</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>mpc_cube <span class="op">=</span> sits_cube(</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    source <span class="op">=</span> <span class="st">"MPC"</span>,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    collection  <span class="op">=</span> <span class="st">"LANDSAT-C2-L2"</span>,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    bands <span class="op">=</span> (<span class="st">"BLUE"</span>, <span class="st">"GREEN"</span>, <span class="st">"RED"</span>, <span class="st">"NIR08"</span>, <span class="st">"SWIR16"</span>, <span class="st">"SWIR22"</span>, <span class="st">"CLOUD"</span>),</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    roi <span class="op">=</span> roi,</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    start_date <span class="op">=</span> <span class="st">"2017-08-29"</span>,</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    end_date <span class="op">=</span> <span class="st">"2018-08-29"</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>The created data cube is not regular (for more details, see <a href="./datacubes.html#regular-earth-observation-data-cubes">Regular Earth observation data cubes</a>), which means that it needs to be regularized before proceeding with the analysis. We recommend copying the images locally before applying the regularization process. Although not mandatory, this is considered a good practice. In cases where the machine does not have sufficient storage space, regularization can be performed directly on the remote data.</p>
<p>In this experiment, we use the <code><a href="https://rdrr.io/pkg/sits/man/sits_cube_copy.html">sits_cube_copy()</a></code> function to copy the remote images locally. This function supports the <code>roi</code> parameter, allowing the images to be cropped during the download process. It also supports the <code>multicores</code> parameter, which can significantly improve download speed.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Copy images locally</span></span>
<span><span class="va">mpc_cube</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_cube_copy.html">sits_cube_copy</a></span><span class="op">(</span></span>
<span>  cube <span class="op">=</span> <span class="va">mpc_cube</span>,</span>
<span>  roi <span class="op">=</span> <span class="va">roi</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="va">tempdir_cerrado_cube</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy images locally</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>mpc_cube <span class="op">=</span> sits_cube_copy(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  cube <span class="op">=</span> mpc_cube,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  roi <span class="op">=</span> roi,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  multicores <span class="op">=</span> <span class="dv">5</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  output_dir <span class="op">=</span> tempdir_cerrado_cube</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>As discussed in the <a href="./datacubes.html">Earth observation data cubes</a> chapter, the SITS package can access both local and remote images. As shown in the code below, we read the images locally after copying them. The only difference between accessing remote and local images is the <code>data_dir</code> parameter, which specifies the directory where the images are stored.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Access local data cube</span></span>
<span><span class="va">mpc_cube</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_cube.html">sits_cube</a></span><span class="op">(</span></span>
<span>    source <span class="op">=</span> <span class="st">"MPC"</span>,</span>
<span>    collection <span class="op">=</span> <span class="st">"LANDSAT-C2-L2"</span>,</span>
<span>    data_dir <span class="op">=</span> <span class="va">tempdir_cerrado_cube</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Access local data cube</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>mpc_cube <span class="op">=</span> sits_cube(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    source <span class="op">=</span> <span class="st">"MPC"</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    collection <span class="op">=</span> <span class="st">"LANDSAT-C2-L2"</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    data_dir <span class="op">=</span> tempdir_cerrado_cube</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>After creating the local data cube, we can proceed with the regularization step using the <code><a href="https://rdrr.io/pkg/sits/man/sits_regularize.html">sits_regularize()</a></code> function. In this case, we provide the timeline parameter to define a custom timeline, specifically the timeline of the reference samples. This ensures consistency between the data cube and the samples. For more details on the regularization process, please refer to the corresponding chapter in <a href="./dc_regularize.html">Building regular data cubes</a>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Samples timeline</span></span>
<span><span class="va">timeline</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_timeline.html">sits_timeline</a></span><span class="op">(</span><span class="va">samples_cerrado_lc8_examples</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Regularize the local cube</span></span>
<span><span class="va">cube_reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_regularize.html">sits_regularize</a></span><span class="op">(</span></span>
<span>    cube <span class="op">=</span> <span class="va">mpc_cube</span>,</span>
<span>    period <span class="op">=</span> <span class="st">"P16D"</span>,</span>
<span>    res <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    roi <span class="op">=</span> <span class="va">roi</span>,</span>
<span>    multicores <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    output_dir <span class="op">=</span> <span class="va">tempdir_cerrado</span>,</span>
<span>    timeline <span class="op">=</span> <span class="va">timeline</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Samples timeline</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>timeline <span class="op">=</span> sits_timeline(samples_cerrado_lc8_examples)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Regularize the local cube</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>cube_reg <span class="op">=</span> sits_regularize(</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    cube <span class="op">=</span> mpc_cube,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    period <span class="op">=</span> <span class="st">"P16D"</span>,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> <span class="dv">30</span>,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    roi <span class="op">=</span> roi,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    multicores <span class="op">=</span> <span class="dv">5</span>,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    output_dir <span class="op">=</span> tempdir_cerrado,</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    timeline <span class="op">=</span> timeline</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="computing-vegetation-indices" class="level3" data-number="2.2.3"><h3 data-number="2.2.3" class="anchored" data-anchor-id="computing-vegetation-indices">
<span class="header-section-number">2.2.3</span> Computing vegetation indices</h3>
<p>SITS provides a range of functions to perform various operations on a data cube, as highlighted in the <a href="./dc_cubeoperations.html">Computing NDVI and other spectral indices</a> chapter. One of these functions is <code><a href="https://rdrr.io/pkg/sits/man/sits_apply.html">sits_apply()</a></code>, which allows users to generate indices using R expressions. In the example below, we compute NDVI and EVI indices to illustrate how this function can be used for generating vegetation indices.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate NDVI index using bands NIR08 and RED</span></span>
<span><span class="va">cube_reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_apply.html">sits_apply</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">cube_reg</span>,</span>
<span>    NDVI <span class="op">=</span> <span class="op">(</span><span class="va">NIR08</span> <span class="op">-</span> <span class="va">RED</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">NIR08</span> <span class="op">+</span> <span class="va">RED</span><span class="op">)</span>,</span>
<span>    output_dir <span class="op">=</span> <span class="va">tempdir_cerrado</span>,</span>
<span>    multicores <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    memsize    <span class="op">=</span> <span class="fl">8</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate EVI index using bands NIR08 and RED</span></span>
<span><span class="va">cube_reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_apply.html">sits_apply</a></span><span class="op">(</span></span>
<span>    data       <span class="op">=</span> <span class="va">cube_reg</span>,</span>
<span>    EVI        <span class="op">=</span> <span class="fl">2.5</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="va">NIR08</span> <span class="op">-</span> <span class="va">RED</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">NIR08</span> <span class="op">+</span> <span class="fl">6</span> <span class="op">*</span> <span class="va">RED</span> <span class="op">-</span> <span class="fl">7.5</span> <span class="op">*</span> <span class="va">BLUE</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    output_dir <span class="op">=</span> <span class="va">tempdir_cerrado</span>,</span>
<span>    multicores <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    memsize    <span class="op">=</span> <span class="fl">8</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot NDVI for the second date (2017-09-14)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cube_reg</span>,</span>
<span>  band <span class="op">=</span> <span class="st">"NDVI"</span>,</span>
<span>  dates <span class="op">=</span> <span class="st">"2017-09-14"</span>,</span>
<span>  palette <span class="op">=</span> <span class="st">"RdYlGn"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate NDVI index using bands NIR08 and RED</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>cube_reg <span class="op">=</span> sits_apply(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> cube_reg,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    NDVI <span class="op">=</span> <span class="st">"(NIR08 - RED) / (NIR08 + RED)"</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    output_dir <span class="op">=</span> tempdir_cerrado,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    multicores <span class="op">=</span> <span class="dv">5</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    memsize    <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate EVI index using bands NIR08 and RED</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>cube_reg <span class="op">=</span> sits_apply(</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    data       <span class="op">=</span> cube_reg,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    EVI        <span class="op">=</span> <span class="st">"2.5 * ((NIR08 - RED) / (NIR08 + 6 * RED - 7.5 * BLUE + 1))"</span>,</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    output_dir <span class="op">=</span> tempdir_cerrado,</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    multicores <span class="op">=</span> <span class="dv">5</span>,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    memsize    <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot NDVI for the second date (2017-09-14)</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>plot(cube_reg,</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  band <span class="op">=</span> <span class="st">"NDVI"</span>,</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  dates <span class="op">=</span> <span class="st">"2017-09-14"</span>,</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  palette <span class="op">=</span> <span class="st">"RdYlGn"</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-nvdvi-intro-cerrado" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/ndvi_intro_cerrado.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2.7: NDVI image generated by <code><a href="https://rdrr.io/pkg/sits/man/sits_apply.html">sits_apply()</a></code>.</figcaption></figure>
</div>
</div>
</div>
</section><section id="getting-time-series" class="level3" data-number="2.2.4"><h3 data-number="2.2.4" class="anchored" data-anchor-id="getting-time-series">
<span class="header-section-number">2.2.4</span> Getting time series</h3>
<p>After creating the data cube, the next step is to extract the time series for the sample locations. Since we already have the samples time series for the entire Cerrado, the code below serves only as an example to demonstrate how to extract sample time series from the data cube.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Extract the time series</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_get_data.html">sits_get_data</a></span><span class="op">(</span></span>
<span>    cube <span class="op">=</span> <span class="va">cube_reg</span>,</span>
<span>    samples <span class="op">=</span> <span class="va">samples_cerrado_lc8_examples</span>,</span>
<span>    multicores <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show the tibble with the first three points</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">samples</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 7
  longitude latitude start_date end_date   label        cube         time_series
      &lt;dbl&gt;    &lt;dbl&gt; &lt;date&gt;     &lt;date&gt;     &lt;chr&gt;        &lt;chr&gt;        &lt;list&gt;     
1     -50.8    -13.4 2017-08-29 2018-08-29 Open_Cerrado LANDSAT-C2-… &lt;tibble&gt;   
2     -50.8    -13.3 2017-08-29 2018-08-29 Open_Cerrado LANDSAT-C2-… &lt;tibble&gt;   
3     -50.8    -13.3 2017-08-29 2018-08-29 Open_Cerrado LANDSAT-C2-… &lt;tibble&gt;   </code></pre>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the time series</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> sits_get_data(</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    cube <span class="op">=</span> cube_reg,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    samples <span class="op">=</span> samples_cerrado_lc8_examples,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    multicores <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the tibble with the first three points</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>samples[<span class="dv">0</span>:<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   longitude   latitude  start_date    end_date         label           cube                                        time_series
0 -50.777271 -13.362440  2017-08-29  2018-08-29  Open_Cerrado  LANDSAT-C2-L2           Index      BLUE     EVI  ...       RE...
1 -50.777271 -13.317524  2017-08-29  2018-08-29  Open_Cerrado  LANDSAT-C2-L2           Index      BLUE     EVI  ...       RE...</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="training-a-deep-learning-model" class="level3" data-number="2.2.5"><h3 data-number="2.2.5" class="anchored" data-anchor-id="training-a-deep-learning-model">
<span class="header-section-number">2.2.5</span> Training a Deep Learning model</h3>
<p>The next step in producing a classified map is training a model. This step consists of two phases: tuning the hyperparameters and training the model. Although hyperparameter tuning is not mandatory, it is highly recommended, as it helps identify the most suitable configuration that best fits the sample data. In this case, we used the Temporal Convolutional Neural Network (TempCNN) model <span class="citation" data-cites="Pelletier2019"><a href="#ref-Pelletier2019" role="doc-biblioref">[12]</a></span>, which was also used by the original authors of the study. The TempCNN architecture contains three layers of 1D convolutions, using kernels to capture local temporal patterns from time series.</p>
<p>In the code below, we tune the TempCNN model by adjusting the number of convolutional layers, kernel sizes, learning rate, and weight decay. This function may take several minutes to execute, depending on the hardware. The execution time can be significantly reduced by leveraging GPU acceleration. For further details, please refer to the <a href="./cl_rasterclassification.html#training-and-running-deep-learning-models">training and running deep learning models</a> section.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tuned_tempcnn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_tuning.html">sits_tuning</a></span><span class="op">(</span></span>
<span>    samples <span class="op">=</span> <span class="va">samples_cerrado_lc8_examples</span>,</span>
<span>    ml_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_tempcnn.html">sits_tempcnn</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_tuning_hparams.html">sits_tuning_hparams</a></span><span class="op">(</span></span>
<span>        optimizer <span class="op">=</span> <span class="fu">torch</span><span class="fu">::</span><span class="va"><a href="https://torch.mlverse.org/docs/reference/optim_adamw.html">optim_adamw</a></span>,</span>
<span>        cnn_layers <span class="op">=</span> <span class="fu">choice</span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">32</span>, <span class="fl">32</span>, <span class="fl">32</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">64</span>, <span class="fl">64</span>, <span class="fl">64</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">128</span>, <span class="fl">128</span>, <span class="fl">128</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        cnn_kernels <span class="op">=</span> <span class="fu">choice</span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">9</span>, <span class="fl">9</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        cnn_dropout_rates <span class="op">=</span> <span class="fu">choice</span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        opt_hparams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>            lr <span class="op">=</span> <span class="fu">uniform</span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>            weight_decay <span class="op">=</span> <span class="fu">uniform</span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">3</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    trials <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    multicores <span class="op">=</span> <span class="fl">8</span>,</span>
<span>    progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Printing the best parameters:</span></span>
<span><span class="va">tuned_tempcnn</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 19
   accuracy kappa acc        samples_validation cnn_layers cnn_kernels
      &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;     &lt;list&gt;             &lt;list&gt;     &lt;list&gt;     
 1    0.885 0.852 &lt;cnfsnMtr&gt; &lt;NULL&gt;             &lt;language&gt; &lt;language&gt; 
 2    0.880 0.845 &lt;cnfsnMtr&gt; &lt;NULL&gt;             &lt;language&gt; &lt;language&gt; 
 3    0.877 0.842 &lt;cnfsnMtr&gt; &lt;NULL&gt;             &lt;language&gt; &lt;language&gt; 
 4    0.876 0.841 &lt;cnfsnMtr&gt; &lt;NULL&gt;             &lt;language&gt; &lt;language&gt; 
 5    0.875 0.838 &lt;cnfsnMtr&gt; &lt;NULL&gt;             &lt;language&gt; &lt;language&gt; 
 6    0.871 0.833 &lt;cnfsnMtr&gt; &lt;NULL&gt;             &lt;language&gt; &lt;language&gt; 
 7    0.869 0.831 &lt;cnfsnMtr&gt; &lt;NULL&gt;             &lt;language&gt; &lt;language&gt; 
 8    0.868 0.830 &lt;cnfsnMtr&gt; &lt;NULL&gt;             &lt;language&gt; &lt;language&gt; 
 9    0.868 0.829 &lt;cnfsnMtr&gt; &lt;NULL&gt;             &lt;language&gt; &lt;language&gt; 
10    0.867 0.828 &lt;cnfsnMtr&gt; &lt;NULL&gt;             &lt;language&gt; &lt;language&gt; 
# ℹ 13 more variables: cnn_dropout_rates &lt;list&gt;, dense_layer_nodes &lt;list&gt;,
#   dense_layer_dropout_rate &lt;list&gt;, epochs &lt;list&gt;, batch_size &lt;list&gt;,
#   validation_split &lt;list&gt;, optimizer &lt;list&gt;, opt_hparams &lt;list&gt;,
#   lr_decay_epochs &lt;list&gt;, lr_decay_rate &lt;list&gt;, patience &lt;list&gt;,
#   min_delta &lt;list&gt;, verbose &lt;list&gt;</code></pre>
</div>
</div>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>tuned_mt <span class="op">=</span> sits_tuning(</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>     samples <span class="op">=</span> samples_matogrosso_mod13q1,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>     ml_method <span class="op">=</span> sits_lighttae,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>     params <span class="op">=</span> sits_tuning_hparams(</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>         optimizer <span class="op">=</span> <span class="st">"torch::optim_adamw"</span>,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>         cnn_layers <span class="op">=</span> hparam(</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"choice"</span>, (<span class="dv">32</span>, <span class="dv">32</span>, <span class="dv">32</span>), (<span class="dv">64</span>, <span class="dv">64</span>, <span class="dv">64</span>), (<span class="dv">128</span>, <span class="dv">128</span>, <span class="dv">128</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>         ),</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>         cnn_kernels <span class="op">=</span> hparam(</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">"choice"</span>, (<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>), (<span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">7</span>), (<span class="dv">9</span>, <span class="dv">9</span>, <span class="dv">9</span>)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>         ),</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>         cnn_dropout_rates <span class="op">=</span> hparam(</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">"choice"</span>, (<span class="fl">0.15</span>, <span class="fl">0.15</span>, <span class="fl">0.15</span>), (<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>), </span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>                        (<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>), (<span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>         ),</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>         opt_hparams <span class="op">=</span> <span class="bu">dict</span>(</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>             lr <span class="op">=</span> hparam(<span class="st">"uniform"</span>, <span class="dv">10</span><span class="op">**-</span><span class="dv">4</span>, <span class="dv">10</span><span class="op">**-</span><span class="dv">2</span>),</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>             weight_decay <span class="op">=</span> hparam(<span class="st">"uniform"</span>, <span class="dv">10</span><span class="op">**-</span><span class="dv">6</span>, <span class="dv">10</span><span class="op">**-</span><span class="dv">3</span>)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>     ),</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>     trials <span class="op">=</span> <span class="dv">40</span>,</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>     multicores <span class="op">=</span> <span class="dv">6</span>,</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>     progress <span class="op">=</span> <span class="va">False</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing the best parameters:</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>tuned_tempcnn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 19
   accuracy kappa acc        samples_validation cnn_layers cnn_kernels
      &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;     &lt;list&gt;             &lt;list&gt;     &lt;list&gt;     
 1    0.885 0.852 &lt;cnfsnMtr&gt; &lt;NULL&gt;             &lt;language&gt; &lt;language&gt; 
 2    0.880 0.845 &lt;cnfsnMtr&gt; &lt;NULL&gt;             &lt;language&gt; &lt;language&gt; 
 3    0.877 0.842 &lt;cnfsnMtr&gt; &lt;NULL&gt;             &lt;language&gt; &lt;language&gt; 
 4    0.876 0.841 &lt;cnfsnMtr&gt; &lt;NULL&gt;             &lt;language&gt; &lt;language&gt; 
 5    0.875 0.838 &lt;cnfsnMtr&gt; &lt;NULL&gt;             &lt;language&gt; &lt;language&gt; 
 6    0.871 0.833 &lt;cnfsnMtr&gt; &lt;NULL&gt;             &lt;language&gt; &lt;language&gt; 
 7    0.869 0.831 &lt;cnfsnMtr&gt; &lt;NULL&gt;             &lt;language&gt; &lt;language&gt; 
 8    0.868 0.830 &lt;cnfsnMtr&gt; &lt;NULL&gt;             &lt;language&gt; &lt;language&gt; 
 9    0.868 0.829 &lt;cnfsnMtr&gt; &lt;NULL&gt;             &lt;language&gt; &lt;language&gt; 
10    0.867 0.828 &lt;cnfsnMtr&gt; &lt;NULL&gt;             &lt;language&gt; &lt;language&gt; 
# ℹ 13 more variables: cnn_dropout_rates &lt;list&gt;, dense_layer_nodes &lt;list&gt;,
#   dense_layer_dropout_rate &lt;list&gt;, epochs &lt;list&gt;, batch_size &lt;list&gt;,
#   validation_split &lt;list&gt;, optimizer &lt;list&gt;, opt_hparams &lt;list&gt;,
#   lr_decay_epochs &lt;list&gt;, lr_decay_rate &lt;list&gt;, patience &lt;list&gt;,
#   min_delta &lt;list&gt;, verbose &lt;list&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>We can now take the best-fitting parameters and use them to train our deep learning model. The selected hyperparameters were 64 convolutional filters, a kernel size of 7, and a dropout rate of 0.3.</p>
</section><section id="training-a-deep-learning-model-1" class="level3" data-number="2.2.6"><h3 data-number="2.2.6" class="anchored" data-anchor-id="training-a-deep-learning-model-1">
<span class="header-section-number">2.2.6</span> Training a deep learning model</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">03022024</span><span class="op">)</span></span>
<span><span class="co"># Train using tempCNN</span></span>
<span><span class="va">tempcnn_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_train.html">sits_train</a></span><span class="op">(</span></span>
<span>  <span class="va">samples_cerrado_lc8_examples</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_tempcnn.html">sits_tempcnn</a></span><span class="op">(</span></span>
<span>    optimizer         <span class="op">=</span> <span class="fu">torch</span><span class="fu">::</span><span class="va"><a href="https://torch.mlverse.org/docs/reference/optim_adamw.html">optim_adamw</a></span>,</span>
<span>    cnn_layers        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">64</span>, <span class="fl">64</span>, <span class="fl">64</span><span class="op">)</span>,</span>
<span>    cnn_kernels       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>    cnn_dropout_rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>    epochs            <span class="op">=</span> <span class="fl">50</span>,</span>
<span>    batch_size        <span class="op">=</span> <span class="fl">256</span>,</span>
<span>    validation_split  <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>    opt_hparams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>lr <span class="op">=</span> <span class="fl">0.002024501</span>,</span>
<span>                       weight_decay <span class="op">=</span> <span class="fl">0.0006641582</span><span class="op">)</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show training evolution</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">tempcnn_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>r_set_seed(<span class="dv">0</span><span class="er">3022024</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Train using tempCNN</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>tempcnn_model <span class="op">=</span> sits_train(</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  samples_cerrado_lc8_examples,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  sits_tempcnn(</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    optimizer         <span class="op">=</span> <span class="st">"torch::optim_adamw"</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    cnn_layers        <span class="op">=</span> (<span class="dv">64</span>, <span class="dv">64</span>, <span class="dv">64</span>),</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    cnn_kernels       <span class="op">=</span> (<span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">7</span>),</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    cnn_dropout_rates <span class="op">=</span> (<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>),</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    epochs            <span class="op">=</span> <span class="dv">50</span>,</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    batch_size        <span class="op">=</span> <span class="dv">256</span>,</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    validation_split  <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    opt_hparams <span class="op">=</span> <span class="bu">dict</span>(lr <span class="op">=</span> <span class="fl">0.002024501</span>,</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>                       weight_decay <span class="op">=</span> <span class="fl">0.0006641582</span>),</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>    verbose <span class="op">=</span> <span class="va">True</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Show training evolution</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>plot(tempcnn_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-intro-cerrado" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/model_intro_cerrado.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2.8: Training loss and validation accuracy over epochs during the TempCNN model training.</figcaption></figure>
</div>
</div>
</div>
</section><section id="data-cube-classification-1" class="level3" data-number="2.2.7"><h3 data-number="2.2.7" class="anchored" data-anchor-id="data-cube-classification-1">
<span class="header-section-number">2.2.7</span> Data cube classification</h3>
<p>The final step is to produce the probability map, which involves applying the trained model to classify the time series within the data cube.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Classify the raster image</span></span>
<span><span class="va">cerrado_probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_classify.html">sits_classify</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">cube_reg</span>,</span>
<span>  ml_model <span class="op">=</span> <span class="va">tempcnn_model</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="va">tempdir_cerrado</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the probability cube for class Forest</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cerrado_probs</span>, labels <span class="op">=</span> <span class="st">"Cerrado"</span>, palette <span class="op">=</span> <span class="st">"BuGn"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Classify the raster image</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>cerrado_probs <span class="op">=</span> sits_classify(</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  data <span class="op">=</span> cube_reg,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  ml_model <span class="op">=</span> tempcnn_model,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  multicores <span class="op">=</span> <span class="dv">5</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  memsize <span class="op">=</span> <span class="dv">8</span>,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  output_dir <span class="op">=</span> tempdir_cerrado</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the probability cube for class Forest</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>plot(cerrado_probs, labels <span class="op">=</span> <span class="st">"Cerrado"</span>, palette <span class="op">=</span> <span class="st">"BuGn"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-probs-intro-cerrado" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/probs_intro_cerrado.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2.9: Probability map for the Cerrado class.</figcaption></figure>
</div>
</div>
</div>
<p>After generating the probability map, we highly recommend applying a smoothing operation based on the spatial neighborhood. This step is essential for incorporating spatial context into the classification results. We used the default values for <code>smoothness</code> and <code>window_size</code>, which serve as a solid starting point. However, we encourage users to adjust these parameters according to the specific needs of their application. For more about the <code><a href="https://rdrr.io/pkg/sits/man/sits_smooth.html">sits_smooth()</a></code> function, please refer to <a href="./cl_smoothing.html">Bayesian smoothing for classification post-processing</a> chapter.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Perform spatial smoothing</span></span>
<span><span class="va">cerrado_bayes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_smooth.html">sits_smooth</a></span><span class="op">(</span></span>
<span>  cube <span class="op">=</span> <span class="va">cerrado_probs</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="va">tempdir_cerrado</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the smooth cube for class Forest</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cerrado_bayes</span>, labels <span class="op">=</span> <span class="st">"Cerrado"</span>, palette <span class="op">=</span> <span class="st">"BuGn"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform spatial smoothing</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>cerrado_bayes <span class="op">=</span> sits_smooth(</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  cube <span class="op">=</span> cerrado_probs,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  multicores <span class="op">=</span> <span class="dv">5</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  memsize <span class="op">=</span> <span class="dv">8</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  output_dir <span class="op">=</span> tempdir_cerrado</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the smooth cube for class Forest</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>plot(cerrado_bayes, labels <span class="op">=</span> <span class="st">"Cerrado"</span>, palette <span class="op">=</span> <span class="st">"BuGn"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-smooth-intro-cerrado" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/smooth_intro_cerrado.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2.10: Smooth map for the Cerrado class.</figcaption></figure>
</div>
</div>
</div>
<p>The final step is labeling the probability map. This involves selecting the highest probability values and assigning class labels to them based on the sample classes.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Label the probability file</span></span>
<span><span class="va">cerrado_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_label_classification.html">sits_label_classification</a></span><span class="op">(</span></span>
<span>  cube <span class="op">=</span> <span class="va">cerrado_bayes</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="va">tempdir_cerrado</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the land use and land cover map</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cerrado_map</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Label the probability file</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>cerrado_map <span class="op">=</span> sits_label_classification(</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  cube <span class="op">=</span> cerrado_bayes,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  output_dir <span class="op">=</span> tempdir_cerrado</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the land use and land cover map</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>plot(cerrado_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-label-intro-cerrado" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/label_intro_cerrado.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2.11: Labeled land use and land cover map for the region of interest.</figcaption></figure>
</div>
</div>
</div>
</section><section id="accuracy-assessment-of-classified-images" class="level3" data-number="2.2.8"><h3 data-number="2.2.8" class="anchored" data-anchor-id="accuracy-assessment-of-classified-images">
<span class="header-section-number">2.2.8</span> Accuracy assessment of classified images</h3>
<p>So far, we have generated the classification for a small region to demonstrate how the SITS package can be applied in a real-world scenario. For the validation step, we extended the classification to the entire Cerrado biome using the reference samples provided by Simoes et al.&nbsp;(2021) <span class="citation" data-cites="Simoes2021"><a href="#ref-Simoes2021" role="doc-biblioref">[8]</a></span>, in order to evaluate the results with real and independently collected data.</p>
<p>we used 5402 validation points, which are independent of the training set used in the classification. They were interpreted by five specialists using high resolution images from the same period of the classification. For the assessment, we merged the labels <code>Cerradao</code>, <code>Cerrado</code>, and <code>Open Cerrado</code> into one label called <code>Cerrado</code>. We also did additional sampling to reach a minimal number of samples for the classes <code>Natural Non Vegetated</code>, <code>Perennial Crop</code>, and <code>Water</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-2" role="tab" aria-controls="tabset-24-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-24-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Cerrado classification file</span></span>
<span><span class="va">cerrado_path</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span></span>
<span>    <span class="st">"/extdata/Cerrado-Class-2017-2018-Mosaic"</span>, package <span class="op">=</span> <span class="st">"sitsdata"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read the probability file</span></span>
<span><span class="va">cerrado_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_cube.html">sits_cube</a></span><span class="op">(</span></span>
<span>    source <span class="op">=</span> <span class="st">"MPC"</span>,</span>
<span>    collection <span class="op">=</span> <span class="st">"LANDSAT-C2-L2"</span>,</span>
<span>    bands <span class="op">=</span> <span class="st">"class"</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"Annual_Crop"</span>, <span class="st">"3"</span> <span class="op">=</span> <span class="st">"Cerrado"</span>, <span class="st">"4"</span> <span class="op">=</span> <span class="st">"Nat_NonVeg"</span>,</span>
<span>               <span class="st">"6"</span> <span class="op">=</span> <span class="st">"Pasture"</span>, <span class="st">"7"</span> <span class="op">=</span> <span class="st">"Perennial_Crop"</span>, <span class="st">"8"</span> <span class="op">=</span> <span class="st">"Silviculture"</span>,</span>
<span>               <span class="st">"9"</span> <span class="op">=</span> <span class="st">"Sugarcane"</span>, <span class="st">"10"</span> <span class="op">=</span> <span class="st">"Water"</span><span class="op">)</span>,</span>
<span>    data_dir <span class="op">=</span> <span class="va">cerrado_path</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot Cerrado map</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cerrado_map</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_examples_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-24-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cerrado classification file</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>cerrado_path <span class="op">=</span> r_package_dir(</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    content_dir <span class="op">=</span> <span class="st">"/extdata/Cerrado-Class-2017-2018-Mosaic"</span>, </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    package <span class="op">=</span> <span class="st">"sitsdata"</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the probability file</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>cerrado_map <span class="op">=</span> sits_cube(</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>    source <span class="op">=</span> <span class="st">"MPC"</span>,</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>    collection <span class="op">=</span> <span class="st">"LANDSAT-C2-L2"</span>,</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>    bands <span class="op">=</span> <span class="st">"class"</span>,</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> {<span class="st">"1"</span>: <span class="st">"Annual_Crop"</span>, <span class="st">"3"</span>: <span class="st">"Cerrado"</span>, <span class="st">"4"</span>: <span class="st">"Nat_NonVeg"</span>,</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>               <span class="st">"6"</span>: <span class="st">"Pasture"</span>, <span class="st">"7"</span>:<span class="st">"Perennial_Crop"</span>, <span class="st">"8"</span>: <span class="st">"Silviculture"</span>,</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>               <span class="st">"9"</span>: <span class="st">"Sugarcane"</span>, <span class="st">"10"</span>: <span class="st">"Water"</span>},</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>    data_dir <span class="op">=</span> cerrado_path</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Cerrado map</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>plot(cerrado_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_examples_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>We used the sits implementation of the area-weighted technique <span class="citation" data-cites="Olofsson2013"><a href="#ref-Olofsson2013" role="doc-biblioref">[13]</a></span> to provide an unbiased estimator for the overall accuracy and the total area of each class based on the reference samples (see <a href="./val_map.html">Map accuracy assessment</a>). The classification accuracies are shown below. The overall accuracy of the classification was 0.83.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-25-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-1" role="tab" aria-controls="tabset-25-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-2" role="tab" aria-controls="tabset-25-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-25-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-25-1-tab">
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Get ground truth points</span></span>
<span><span class="va">valid_csv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/csv/cerrado_lc8_validation.csv"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"sitsdata"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate accuracy according to Olofsson's method</span></span>
<span><span class="va">area_acc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_accuracy.html">sits_accuracy</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">cerrado_map</span>,</span>
<span>  validation <span class="op">=</span> <span class="va">valid_csv</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the area estimated accuracy</span></span>
<span><span class="va">area_acc</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area Weighted Statistics
Overall Accuracy = 0.83

Area-Weighted Users and Producers Accuracy
               User Producer
Annual_Crop    0.87     0.82
Cerrado        0.91     0.86
Nat_NonVeg     0.94     0.27
Pasture        0.69     0.79
Perennial_Crop 0.71     0.38
Silviculture   0.82     0.80
Sugarcane      0.72     0.89
Water          0.94     0.71

Mapped Area x Estimated Area (ha)
               Mapped Area (ha) Error-Adjusted Area (ha) Conf Interval (ha)
Annual_Crop          22007606.5               23336717.8          1111777.8
Cerrado             116681183.2              122786133.9          2085647.1
Nat_NonVeg             261234.6                 911153.3           353704.1
Pasture              64237851.8               56008536.3          2155334.6
Perennial_Crop         650393.2                1215456.5           382474.6
Silviculture          4120936.3                4179525.9           506675.9
Sugarcane             4660479.4                3738766.0           508507.4
Water                 1357575.1                1800970.6           320731.0</code></pre>
</div>
</div>
</div>
<div id="tabset-25-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get ground truth points</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>valid_csv <span class="op">=</span> r_package_dir(</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    content_dir <span class="op">=</span> <span class="st">"extdata/csv/cerrado_lc8_validation.csv"</span>,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    package <span class="op">=</span> <span class="st">"sitsdata"</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate accuracy according to Olofsson's method</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>area_acc <span class="op">=</span> sits_accuracy(</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  data <span class="op">=</span> cerrado_map,</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  validation <span class="op">=</span> valid_csv,</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  multicores <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the area estimated accuracy</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>area_acc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Area Weighted Statistics
Overall Accuracy = 0.83

Area-Weighted Users and Producers Accuracy
               User Producer
Annual_Crop    0.87     0.82
Cerrado        0.91     0.86
Nat_NonVeg     0.94     0.27
Pasture        0.69     0.79
Perennial_Crop 0.71     0.38
Silviculture   0.82     0.80
Sugarcane      0.72     0.89
Water          0.94     0.71

Mapped Area x Estimated Area (ha)
               Mapped Area (ha) Error-Adjusted Area (ha) Conf Interval (ha)
Annual_Crop          22007606.5               23336717.8          1111777.8
Cerrado             116681183.2              122786133.9          2085647.1
Nat_NonVeg             261234.6                 911153.3           353704.1
Pasture              64237851.8               56008536.3          2155334.6
Perennial_Crop         650393.2                1215456.5           382474.6
Silviculture          4120936.3                4179525.9           506675.9
Sugarcane             4660479.4                3738766.0           508507.4
Water                 1357575.1                1800970.6           320731.0</code></pre>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="conclusion" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Conclusion</h1>
<p>These examples demonstrate the complete workflow for generating a classified land use and land cover map using the SITS package. The process includes data cube creation, sample extraction, model training with machine and deep learning approaches, classification, and post-processing steps such as smoothing and labeling. By following these steps, users can apply the SITS package to produce accurate and spatially coherent maps from satellite image time series, supporting environmental monitoring and land change analysis.</p>
<hr>


<div id="refs" class="references csl-bib-body" role="list">
<div id="ref-Nepstad1999" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1] </div>
<div class="csl-right-inline">D. C. Nepstad <em>et al.</em>, <span>“Large-scale impoverishment of <span>Amazonian</span> forests by logging and fire,”</span> <em>Nature</em>, vol. 398, no. 6727, pp. 505–508, 1999, doi: <a href="https://doi.org/10.1038/19066">10.1038/19066</a>.</div>
</div>
<div id="ref-Gerwing2002" class="csl-entry" role="listitem">
<div class="csl-left-margin">[2] </div>
<div class="csl-right-inline">J. J. Gerwing, <span>“Degradation of forests through logging and fire in the eastern <span>Brazilian Amazon</span>,”</span> <em>Forest Ecology and Management</em>, vol. 157, no. 1, pp. 131–141, 2002, doi: <a href="https://doi.org/10.1016/S0378-1127(00)00644-7">10.1016/S0378-1127(00)00644-7</a>.</div>
</div>
<div id="ref-Pelletier2016" class="csl-entry" role="listitem">
<div class="csl-left-margin">[3] </div>
<div class="csl-right-inline">C. Pelletier, S. Valero, J. Inglada, N. Champion, and G. Dedieu, <span>“Assessing the robustness of <span>Random Forests</span> to map land cover with high resolution satellite image time series over large areas,”</span> <em>Remote Sensing of Environment</em>, vol. 187, pp. 156–168, 2016, doi: <a href="https://doi.org/10.1016/j.rse.2016.10.010">10.1016/j.rse.2016.10.010</a>.</div>
</div>
<div id="ref-Klink2005" class="csl-entry" role="listitem">
<div class="csl-left-margin">[4] </div>
<div class="csl-right-inline">C. A. Klink and R. B. Machado, <span>“Conservation of the <span>Brazilian</span> cerrado,”</span> <em>Conservation Biology</em>, vol. 19, no. 3, pp. 707–713, 2005.</div>
</div>
<div id="ref-Goodland1971" class="csl-entry" role="listitem">
<div class="csl-left-margin">[5] </div>
<div class="csl-right-inline">R. Goodland, <span>“A <span>Physiognomic Analysis</span> of the <span>‘<span>Cerrado</span>’</span> <span>Vegetation</span> of <span>Central Brasil</span>,”</span> <em>The Journal of Ecology</em>, vol. 59, no. 2, p. 411, 1971, doi: <a href="https://doi.org/10.2307/2258321">10.2307/2258321</a>.</div>
</div>
<div id="ref-Del-Claro2019" class="csl-entry" role="listitem">
<div class="csl-left-margin">[6] </div>
<div class="csl-right-inline">K. Del-Claro and H. M. Torezan-Silingardi, <span>“The study of biotic interactions in the <span>Brazilian Cerrado</span> as a path to the conservation of biodiversity,”</span> <em>Anais da Academia Brasileira de Ci<span>ê</span>ncias</em>, vol. 91, no. suppl 3, p. e20180768, 2019, doi: <a href="https://doi.org/10.1590/0001-3765201920180768">10.1590/0001-3765201920180768</a>.</div>
</div>
<div id="ref-Walter2006" class="csl-entry" role="listitem">
<div class="csl-left-margin">[7] </div>
<div class="csl-right-inline">B. M. T. Walter, <span>“<span class="nocase">Fitofisionomias do bioma Cerrado: s<span class="nocase">í</span>ntese terminol<span class="nocase">ó</span>gica e rela<span class="nocase">ç</span><span class="nocase">õ</span>es flor<span class="nocase">í</span>sticas.</span>”</span> PhD thesis, Universidade de Brasilia, 2006.</div>
</div>
<div id="ref-Simoes2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">[8] </div>
<div class="csl-right-inline">R. Simoes <em>et al.</em>, <span>“Satellite <span>Image Time Series Analysis</span> for <span>Big Earth Observation Data</span>,”</span> <em>Remote Sensing</em>, vol. 13, no. 13, p. 2428, 2021, doi: <a href="https://doi.org/10.3390/rs13132428">10.3390/rs13132428</a>.</div>
</div>
<div id="ref-Parente2019" class="csl-entry" role="listitem">
<div class="csl-left-margin">[9] </div>
<div class="csl-right-inline">L. Parente, V. Mesquita, F. Miziara, L. Baumann, and L. Ferreira, <span>“Assessing the pasturelands and livestock dynamics in <span>Brazil</span>, from 1985 to 2017: <span>A</span> novel approach based on high spatial resolution imagery and <span>Google Earth Engine</span> cloud computing,”</span> <em>Remote Sensing of Environment</em>, vol. 232, p. 111301, 2019, doi: <a href="https://doi.org/10.1016/j.rse.2019.111301">10.1016/j.rse.2019.111301</a>.</div>
</div>
<div id="ref-Souza2020" class="csl-entry" role="listitem">
<div class="csl-left-margin">[10] </div>
<div class="csl-right-inline">C. M. Souza Jr <em>et al.</em>, <span>“Reconstructing three decades of land use and land cover changes in brazilian biomes with landsat archive and earth engine,”</span> <em>Remote Sensing</em>, vol. 12, no. 17, p. 2735, 2020.</div>
</div>
<div id="ref-IBGE2020" class="csl-entry" role="listitem">
<div class="csl-left-margin">[11] </div>
<div class="csl-right-inline">IBGE, <span>“<span class="nocase">Monitoramento da cobertura e uso da terra do Brasil: 2016–2018</span>,”</span> <span>Brazilian Institute of Geography and Statistics</span>, Rio de Janeiro, {Book} 101703, 2020. [Online]. Available: <a href="https://biblioteca.ibge.gov.br/index.php/biblioteca-catalogo?view=detalhes&amp;id=2101703">https://biblioteca.ibge.gov.br/index.php/biblioteca-catalogo?view=detalhes&amp;id=2101703</a>.</div>
</div>
<div id="ref-Pelletier2019" class="csl-entry" role="listitem">
<div class="csl-left-margin">[12] </div>
<div class="csl-right-inline">C. Pelletier, G. I. Webb, and F. Petitjean, <span>“Temporal <span>Convolutional Neural Network</span> for the <span>Classification</span> of <span>Satellite Image Time Series</span>,”</span> <em>Remote Sensing</em>, vol. 11, no. 5, 2019.</div>
</div>
<div id="ref-Olofsson2013" class="csl-entry" role="listitem">
<div class="csl-left-margin">[13] </div>
<div class="csl-right-inline">P. Olofsson, G. M. Foody, S. V. Stehman, and C. E. Woodcock, <span>“Making better use of accuracy data in land change studies: <span>Estimating</span> accuracy and area and quantifying uncertainty using stratified estimation,”</span> <em>Remote Sensing of Environment</em>, vol. 129, pp. 122–131, 2013, doi: <a href="https://doi.org/10.1016/j.rse.2012.10.031">10.1016/j.rse.2012.10.031</a>.</div>
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./intro_quicktour.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">A quick tour of SITS</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./intro_visualisation.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data visualisation in SITS</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">The SITS book was written by Gilberto Camara, Rolf Simoes, Felipe Souza, Felipe Carlos, Pedro Andrade, Karine Ferreira, Pedro Brito, Alexandre Assunção, and Charlotte Pelletier.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>