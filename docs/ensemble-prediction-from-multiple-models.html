<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Ensemble prediction from multiple models | sits: Satellite Image Time Series Analysis on Earth Observation Data Cubes</title>
<meta name="author" content="Gilberto Camara">
<meta name="author" content="Rolf Simoes">
<meta name="author" content="Felipe Souza">
<meta name="author" content="Felipe Menino">
<meta name="author" content="Charlotte Pelletier">
<meta name="author" content="Pedro R. Andrade">
<meta name="author" content="Karine Ferreira">
<meta name="author" content="Gilberto Queiroz">
<meta name="description" content="Ensemble prediction is a powerful technique for combining predictions from multiple models to produce more accurate and robust predictions. Errors of individual models cancel out or are reduced...">
<meta name="generator" content="bookdown 0.39 with bs4_book()">
<meta property="og:title" content="Ensemble prediction from multiple models | sits: Satellite Image Time Series Analysis on Earth Observation Data Cubes">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/cover_sits_book.png">
<meta property="og:description" content="Ensemble prediction is a powerful technique for combining predictions from multiple models to produce more accurate and robust predictions. Errors of individual models cancel out or are reduced...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ensemble prediction from multiple models | sits: Satellite Image Time Series Analysis on Earth Observation Data Cubes">
<meta name="twitter:description" content="Ensemble prediction is a powerful technique for combining predictions from multiple models to produce more accurate and robust predictions. Errors of individual models cancel out or are reduced...">
<meta name="twitter:image" content="/images/cover_sits_book.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/IBM_Plex_Serif-0.4.9/font.css" rel="stylesheet">
<link href="libs/IBM_Plex_Mono-0.4.9/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title=""><strong>sits</strong>: Satellite Image Time Series Analysis on Earth Observation Data Cubes</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="setup.html">Setup</a></li>
<li><a class="" href="acknowledgements.html">Acknowledgements</a></li>
<li><a class="" href="introduction.html">Introduction</a></li>
<li><a class="" href="earth-observation-data-cubes.html">Earth observation data cubes</a></li>
<li><a class="" href="operations-on-data-cubes.html">Operations on data cubes</a></li>
<li><a class="" href="working-with-time-series.html">Working with time series</a></li>
<li><a class="" href="improving-the-quality-of-training-samples.html">Improving the quality of training samples</a></li>
<li><a class="" href="machine-learning-for-data-cubes.html">Machine learning for data cubes</a></li>
<li><a class="" href="classification-of-raster-data-cubes.html">Classification of raster data cubes</a></li>
<li><a class="" href="bayesian-smoothing-for-post-processing.html">Bayesian smoothing for post-processing</a></li>
<li><a class="" href="validation-and-accuracy-measurements.html">Validation and accuracy measurements</a></li>
<li><a class="" href="uncertainty-and-active-learning.html">Uncertainty and active learning</a></li>
<li><a class="active" href="ensemble-prediction-from-multiple-models.html">Ensemble prediction from multiple models</a></li>
<li><a class="" href="object-based-time-series-image-analysis.html">Object-based time series image analysis</a></li>
<li><a class="" href="data-visualisation-in-sits.html">Data visualisation in sits</a></li>
<li><a class="" href="technical-annex.html">Technical annex</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="ensemble-prediction-from-multiple-models" class="section level1 unnumbered">
<h1>Ensemble prediction from multiple models<a class="anchor" aria-label="anchor" href="#ensemble-prediction-from-multiple-models"><i class="fas fa-link"></i></a>
</h1>
<p>Ensemble prediction is a powerful technique for combining predictions from multiple models to produce more accurate and robust predictions. Errors of individual models cancel out or are reduced when combined with the predictions of other models. As a result, ensemble predictions can lead to better overall accuracy and reduce the risk of overfitting. This can be especially useful when working with complex or uncertain data. By combining the predictions of multiple models, users can identify which features or factors are most important for making accurate predictions. When using ensemble methods, choosing diverse models with different sources of error is essential to ensure that the ensemble predictions are more precise and robust.</p>
<p>The <code>sits</code> package provides <code><a href="https://rdrr.io/pkg/sits/man/sits_combine_predictions.html">sits_combine_predictions()</a></code> to estimate ensemble predictions using probability cubes produced by <code><a href="https://rdrr.io/pkg/sits/man/sits_classify.html">sits_classify()</a></code> and optionally post-processed with <code><a href="https://rdrr.io/pkg/sits/man/sits_smooth.html">sits_smooth()</a></code>. There are two ways to make ensemble predictions from multiple models:</p>
<ul>
<li><p>Averaging: In this approach, the predictions of each model are averaged to produce the final prediction. This method works well when the models have similar accuracy and errors.</p></li>
<li><p>Uncertainty: Predictions from different models are compared in terms of their uncertainties on a pixel-by-pixel basis; predictions with lower uncertainty are chosen as being more likely to be valid.</p></li>
</ul>
<p>In what follows, we will use the same sample dataset and data cube used in Chapter <a href="https://e-sensing.github.io/sitsbook/image-classification-in-data-cubes.html">Image classification in data cubes</a> to illustrate how to produce an ensemble prediction. The dataset <code>samples_deforestation_rondonia</code> consists of 6007 samples collected from Sentinel-2 images covering the state of Rondonia. Each time series contains values from all Sentinel-2/2A spectral bands for year 2022 in 16-day intervals. The data cube is a subset of the Sentinel-2 tile “20LMR” which contains all spectral bands, plus spectral indices “NVDI”, “EVI” and “NBR” for the year 2022.</p>
<p>The first step is to recover the data cube which is available in the <code>sitsdata</code> package, and to select only the spectral bands.</p>
<div class="sourceCode" id="cb223"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Files are available in a local directory</span></span>
<span><span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/Rondonia-20LMR/"</span>, package <span class="op">=</span> <span class="st">"sitsdata"</span><span class="op">)</span></span>
<span><span class="co"># Read data cube</span></span>
<span><span class="va">ro_cube_20LMR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_cube.html">sits_cube</a></span><span class="op">(</span></span>
<span>  source <span class="op">=</span> <span class="st">"MPC"</span>,</span>
<span>  collection <span class="op">=</span> <span class="st">"SENTINEL-2-L2A"</span>,</span>
<span>  data_dir <span class="op">=</span> <span class="va">data_dir</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># reduce the number of bands</span></span>
<span><span class="va">ro_cube_20LMR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_select.html">sits_select</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">ro_cube_20LMR</span>,</span>
<span>  bands <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"B02"</span>, <span class="st">"B03"</span>, <span class="st">"B04"</span>, <span class="st">"B05"</span>, <span class="st">"B06"</span>, <span class="st">"B07"</span>, <span class="st">"B08"</span>, <span class="st">"B11"</span>, <span class="st">"B12"</span>, <span class="st">"B8A"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># plot one time step of the cube</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ro_cube_20LMR</span>, blue <span class="op">=</span> <span class="st">"B02"</span>, green <span class="op">=</span> <span class="st">"B8A"</span>, red <span class="op">=</span> <span class="st">"B11"</span>, date <span class="op">=</span> <span class="st">"2022-08-17"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ensmapfirst"></span>
<img src="13-ensembleprediction_files/figure-html/ensmapfirst-1.png" alt="Subset of Sentinel-2 tile 20LMR ((&amp;copy;: EU Copernicus Sentinel Programme; source: Microsoft)." width="100%"><p class="caption">
Figure 108: Subset of Sentinel-2 tile 20LMR ((©: EU Copernicus Sentinel Programme; source: Microsoft).
</p>
</div>
<p>We will train three models: Random Forests (RF), Light Temporal Attention Encoder (LTAE), and Temporal Convolution Neural Networks (TempCNN), classify the cube with them, and then combine their results. The example uses all spectral bands. We first run the RF classification.</p>
<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># train a random forest model</span></span>
<span><span class="va">rfor_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_train.html">sits_train</a></span><span class="op">(</span><span class="va">samples_deforestation_rondonia</span>, <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_rfor.html">sits_rfor</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># classify the data cube</span></span>
<span><span class="va">ro_cube_20LMR_rfor_probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_classify.html">sits_classify</a></span><span class="op">(</span></span>
<span>  <span class="va">ro_cube_20LMR</span>,</span>
<span>  <span class="va">rfor_model</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13"</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"rfor"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ro_cube_20LMR_rfor_variance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_variance.html">sits_variance</a></span><span class="op">(</span></span>
<span>  <span class="va">ro_cube_20LMR_rfor_probs</span>,</span>
<span>  window_size <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13"</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"rfor"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ro_cube_20LMR_rfor_variance</span><span class="op">)</span></span></code></pre></div>
<pre><code>#&gt;      Clear_Cut_Bare_Soil Clear_Cut_Burned_Area Clear_Cut_Vegetation  Forest
#&gt; 75%                 4.73                4.8225                0.380  0.9000
#&gt; 80%                 5.29                5.3020                0.460  1.2500
#&gt; 85%                 5.64                5.6400                0.570  1.9915
#&gt; 90%                 5.98                5.9900                0.830  4.0500
#&gt; 95%                 6.62                6.6605                4.261  6.3800
#&gt; 100%               18.44               16.1800               13.390 23.4400
#&gt;      Mountainside_Forest Riparian_Forest Seasonally_Flooded   Water Wetland
#&gt; 75%               0.8000          0.9800               0.35  1.0300    4.71
#&gt; 80%               2.2000          1.4520               0.45  1.5100    5.23
#&gt; 85%               4.0415          2.6115               0.65  2.3800    5.63
#&gt; 90%               5.4400          4.3800               1.08  3.8000    5.97
#&gt; 95%               6.4200          6.0200               3.15  7.5715    6.49
#&gt; 100%             12.5200         29.5500              18.67 51.5200   17.74</code></pre>
<p>Based on the variance values, we apply the smoothness hyperparameter according to the recommendations proposed before. We choose values of <span class="math inline">\(\sigma^2_{k}\)</span> that reflect our prior expectation of the spatial patterns of each class. For classes <code>Clear_Cut_Vegetation</code> and <code>Clear_Cut_Burned_Area</code>, to produce denser spatial clusters and remove “salt-and-pepper” outliers, we take <span class="math inline">\(\sigma^2_{k}\)</span> values in 95%-100% range. In the case of the most frequent classes <code>Forest</code> and <code>Clear_Cut_Bare_Soil</code> we want to preserve their original spatial shapes as much as possible; the same logic applies to less frequent classes <code>Water</code> and <code>Wetland</code>. For this reason, we set <span class="math inline">\(\sigma^2_{k}\)</span> values in the 75%-80% range for these classes. The class spatial patterns correspond to our prior expectations.</p>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ro_cube_20LMR_rfor_bayes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_smooth.html">sits_smooth</a></span><span class="op">(</span></span>
<span>  <span class="va">ro_cube_20LMR_rfor_probs</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13"</span>,</span>
<span>  smoothness <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Clear_Cut_Bare_Soil"</span> <span class="op">=</span> <span class="fl">5.25</span>,</span>
<span>    <span class="st">"Clear_Cut_Burned_Area"</span> <span class="op">=</span> <span class="fl">15.0</span>,</span>
<span>    <span class="st">"Clear_Cut_Vegetation"</span> <span class="op">=</span> <span class="fl">12.0</span>,</span>
<span>    <span class="st">"Forest"</span> <span class="op">=</span> <span class="fl">1.8</span>,</span>
<span>    <span class="st">"Mountainside_Forest"</span> <span class="op">=</span> <span class="fl">6.5</span>,</span>
<span>    <span class="st">"Riparian_Forest"</span> <span class="op">=</span> <span class="fl">6.0</span>,</span>
<span>    <span class="st">"Seasonally_Flooded"</span> <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>    <span class="st">"Water"</span> <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>    <span class="st">"Wetland"</span> <span class="op">=</span> <span class="fl">5.5</span></span>
<span>  <span class="op">)</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"rfor"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ro_cube_20LMR_rfor_class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_label_classification.html">sits_label_classification</a></span><span class="op">(</span></span>
<span>  <span class="va">ro_cube_20LMR_rfor_bayes</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13"</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"rfor"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb227"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ro_cube_20LMR_rfor_class</span>,</span>
<span>  legend_text_size <span class="op">=</span> <span class="fl">0.7</span>, legend_position <span class="op">=</span> <span class="st">"outside"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unrforclass"></span>
<img src="13-ensembleprediction_files/figure-html/unrforclass-1.png" alt="Land classification in Rondonia using a random forest algorithm  (source: authors)." width="100%"><p class="caption">
Figure 109: Land classification in Rondonia using a random forest algorithm (source: authors).
</p>
</div>
<p>The next step is to classify the same area using a tempCNN algorithm, as shown below.</p>
<div class="sourceCode" id="cb228"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># train a tempcnn model</span></span>
<span><span class="va">tcnn_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_train.html">sits_train</a></span><span class="op">(</span></span>
<span>  <span class="va">samples_deforestation_rondonia</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_tempcnn.html">sits_tempcnn</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># classify the data cube</span></span>
<span><span class="va">ro_cube_20LMR_tcnn_probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_classify.html">sits_classify</a></span><span class="op">(</span></span>
<span>  <span class="va">ro_cube_20LMR</span>,</span>
<span>  <span class="va">tcnn_model</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13"</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  gpu_memory <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"tcnn"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ro_cube_20LMR_tcnn_variance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_variance.html">sits_variance</a></span><span class="op">(</span></span>
<span>  <span class="va">ro_cube_20LMR_tcnn_probs</span>,</span>
<span>  window_size <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13"</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"tcnn"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ro_cube_20LMR_tcnn_variance</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb229"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ro_cube_20LMR_tcnn_bayes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_smooth.html">sits_smooth</a></span><span class="op">(</span></span>
<span>  <span class="va">ro_cube_20LMR_tcnn_probs</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13"</span>,</span>
<span>  window_size <span class="op">=</span> <span class="fl">11</span>,</span>
<span>  smoothness <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Clear_Cut_Bare_Soil"</span> <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>    <span class="st">"Clear_Cut_Burned_Area"</span> <span class="op">=</span> <span class="fl">20.0</span>,</span>
<span>    <span class="st">"Clear_Cut_Vegetation"</span> <span class="op">=</span> <span class="fl">25.0</span>,</span>
<span>    <span class="st">"Forest"</span> <span class="op">=</span> <span class="fl">4.0</span>,</span>
<span>    <span class="st">"Mountainside_Forest"</span> <span class="op">=</span> <span class="fl">3.0</span>,</span>
<span>    <span class="st">"Riparian_Forest"</span> <span class="op">=</span> <span class="fl">40.0</span>,</span>
<span>    <span class="st">"Seasonally_Flooded"</span> <span class="op">=</span> <span class="fl">30.0</span>,</span>
<span>    <span class="st">"Water"</span> <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>    <span class="st">"Wetland"</span> <span class="op">=</span> <span class="fl">2.0</span></span>
<span>  <span class="op">)</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"tcnn"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ro_cube_20LMR_tcnn_class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_label_classification.html">sits_label_classification</a></span><span class="op">(</span></span>
<span>  <span class="va">ro_cube_20LMR_tcnn_bayes</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13"</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"tcnn"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ro_cube_20LMR_tcnn_class</span>,</span>
<span>  legend_text_size <span class="op">=</span> <span class="fl">0.7</span>, legend_position <span class="op">=</span> <span class="st">"outside"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:untcnnmap"></span>
<img src="13-ensembleprediction_files/figure-html/untcnnmap-1.png" alt="Land classification in Rondonia using tempCNN (source: authors)." width="100%"><p class="caption">
Figure 110: Land classification in Rondonia using tempCNN (source: authors).
</p>
</div>
<p>The third model is the Light Temporal Attention Encoder (LTAE), which has been discussed.</p>
<div class="sourceCode" id="cb231"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># train a tempcnn model</span></span>
<span><span class="va">ltae_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_train.html">sits_train</a></span><span class="op">(</span><span class="va">samples_deforestation_rondonia</span>, <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_lighttae.html">sits_lighttae</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># classify the data cube</span></span>
<span><span class="va">ro_cube_20LMR_ltae_probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_classify.html">sits_classify</a></span><span class="op">(</span></span>
<span>  <span class="va">ro_cube_20LMR</span>,</span>
<span>  <span class="va">ltae_model</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13"</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  gpu_memory <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"ltae"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ro_cube_20LMR_ltae_variance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_variance.html">sits_variance</a></span><span class="op">(</span></span>
<span>  <span class="va">ro_cube_20LMR_ltae_probs</span>,</span>
<span>  window_size <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13"</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"ltae"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ro_cube_20LMR_ltae_variance</span><span class="op">)</span></span></code></pre></div>
<p>We use the same rationale for selecting the <code>smoothness</code> parameter for the Bayesian smoothing operation as in the cases above.</p>
<div class="sourceCode" id="cb232"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ro_cube_20LMR_ltae_bayes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_smooth.html">sits_smooth</a></span><span class="op">(</span></span>
<span>  <span class="va">ro_cube_20LMR_tcnn_probs</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13"</span>,</span>
<span>  window_size <span class="op">=</span> <span class="fl">11</span>,</span>
<span>  smoothness <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Clear_Cut_Bare_Soil"</span> <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>    <span class="st">"Clear_Cut_Burned_Area"</span> <span class="op">=</span> <span class="fl">10.0</span>,</span>
<span>    <span class="st">"Clear_Cut_Vegetation"</span> <span class="op">=</span> <span class="fl">15.0</span>,</span>
<span>    <span class="st">"Forest"</span> <span class="op">=</span> <span class="fl">4.0</span>,</span>
<span>    <span class="st">"Mountainside_Forest"</span> <span class="op">=</span> <span class="fl">8.0</span>,</span>
<span>    <span class="st">"Riparian_Forest"</span> <span class="op">=</span> <span class="fl">25.0</span>,</span>
<span>    <span class="st">"Seasonally_Flooded"</span> <span class="op">=</span> <span class="fl">30.0</span>,</span>
<span>    <span class="st">"Water"</span> <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>    <span class="st">"Wetland"</span> <span class="op">=</span> <span class="fl">1.8</span></span>
<span>  <span class="op">)</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"ltae"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ro_cube_20LMR_ltae_class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_label_classification.html">sits_label_classification</a></span><span class="op">(</span></span>
<span>  <span class="va">ro_cube_20LMR_ltae_bayes</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13"</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"ltae"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb233"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ro_cube_20LMR_ltae_class</span>,</span>
<span>  legend_text_size <span class="op">=</span> <span class="fl">0.7</span>, legend_position <span class="op">=</span> <span class="st">"outside"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unltaemap"></span>
<img src="13-ensembleprediction_files/figure-html/unltaemap-1.png" alt="Land classification in Rondonia using tempCNN (source: authors)." width="100%"><p class="caption">
Figure 111: Land classification in Rondonia using tempCNN (source: authors).
</p>
</div>
<p>To understand the differences between the results, it is useful to compare the resulting class areas produced by the different algorithms.</p>
<div class="sourceCode" id="cb234"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the summary of the map produced by RF</span></span>
<span><span class="va">sum1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ro_cube_20LMR_rfor_class</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="st">"class"</span>, <span class="st">"area_km2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">sum1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"class"</span>, <span class="st">"rfor"</span><span class="op">)</span></span>
<span><span class="co"># get the summary of the map produced by TCNN</span></span>
<span><span class="va">sum2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ro_cube_20LMR_tcnn_class</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="st">"class"</span>, <span class="st">"area_km2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">sum2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"class"</span>, <span class="st">"tcnn"</span><span class="op">)</span></span>
<span><span class="co"># get the summary of the map produced by LTAE</span></span>
<span><span class="va">sum3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ro_cube_20LMR_ltae_class</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="st">"class"</span>, <span class="st">"area_km2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">sum3</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"class"</span>, <span class="st">"ltae"</span><span class="op">)</span></span>
<span><span class="co"># compare class areas of non-smoothed and smoothed maps</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">sum1</span>, <span class="va">sum2</span>, by <span class="op">=</span> <span class="st">"class"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">sum3</span>, by <span class="op">=</span> <span class="st">"class"</span><span class="op">)</span></span></code></pre></div>
<pre><code>#&gt; # A tibble: 9 × 4
#&gt;   class                     rfor   tcnn    ltae
#&gt;   &lt;chr&gt;                    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
#&gt; 1 Clear_Cut_Bare_Soil    80       68     68    
#&gt; 2 Clear_Cut_Burned_Area   1.7      4.7    4.8  
#&gt; 3 Clear_Cut_Vegetation   19       14     14    
#&gt; 4 Forest                280      240    240    
#&gt; 5 Mountainside_Forest     0.0088   0.04   0.028
#&gt; 6 Riparian_Forest        47       40     40    
#&gt; 7 Seasonally_Flooded     70      130    130    
#&gt; 8 Water                  63       67     66    
#&gt; 9 Wetland                14       13     13</code></pre>
<p>The study area presents many challenges for land classification, given the presence of wetlands, riparian forests and seasonally-flooded areas. The results show the algorithms obtain quite different results, since each model has different sensitivities. The RF method is biased towards the most frequent classes, especially for <code>Clear_Cut_Bare_Soil</code> and <code>Forest</code>. The area estimated by RF for class <code>Clear_Cut_Burned_Area</code> is the smallest of the three models. Most pixels assigned by LTAE and TCNN as burned areas are assigned by RF as being areas of bare soil. The RF algorithm tends to be more conservative. The reason is because RF decision-making uses values from single attributes (values of a single band in a given time instance), while LTAE and TCNN consider the relations between instances of the time series. Since the RF model is sensitive to the response of images at the end of the period, it tends to focus on values that indicate the presence of forests and bare soils during the dry season, which peaks in August. The LTAE model is more balanced to the overall separation of classes in the entire attribute space, and produces larger estimates of riparian and seasonally flooded forest than the other methods. In contrast, both LTAE and TCNN make more mistakes than RF in including flooded areas in the center-left part of the image on the left side of the rives as <code>Clear_Cut_Vegetation</code> when the right label would be riparian or flooded forests.</p>
<p>Given the differences and complementaries between the three predicted outcomes, combining them using <code><a href="https://rdrr.io/pkg/sits/man/sits_combine_predictions.html">sits_combine_predictions()</a></code> is useful. This function takes the following arguments: (a) <code>cubes</code>, a list of the cubes to be combined. These cubes should be probability cubes generated by which optionally may have been smoothened; (b) <code>type</code>, which indicates how to combine the probability maps. The options are <code>average</code>, which performs a weighted mean of the probabilities, and <code>uncertainty</code>, which uses the uncertainty cubes to combine the predictions; (c) <code>weights</code>, a vector of weights to be used to combine the predictions when <code>average</code> is selected; (d) <code>uncertainty_cubes</code>, a list of uncertainty cubes associated to the predictions; (e) <code>multicores</code>, number of cores to be used; (f) <code>memsize</code>, RAM used in the classification; (g) <code>output_dir</code>, the directory where the classified raster files will be written.</p>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Combine the two predictions by taking the average of the probabilities for each class</span></span>
<span><span class="va">ro_cube_20LMR_average_probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_combine_predictions.html">sits_combine_predictions</a></span><span class="op">(</span></span>
<span>  cubes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="va">ro_cube_20LMR_tcnn_bayes</span>,</span>
<span>    <span class="va">ro_cube_20LMR_rfor_bayes</span>,</span>
<span>    <span class="va">ro_cube_20LMR_ltae_bayes</span></span>
<span>  <span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"average"</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"average-rfor-tcnn-ltae"</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13/"</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.33</span>, <span class="fl">0.34</span>, <span class="fl">0.33</span><span class="op">)</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Label the average probability cube</span></span>
<span><span class="va">ro_cube_20LMR_average_class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_label_classification.html">sits_label_classification</a></span><span class="op">(</span></span>
<span>  cube <span class="op">=</span> <span class="va">ro_cube_20LMR_average_probs</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13/"</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"average-rfor-tcnn-ltae"</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb237"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the second version of the classified cube</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ro_cube_20LMR_average_class</span>,</span>
<span>  legend_text_size <span class="op">=</span> <span class="fl">0.7</span>, legend_position <span class="op">=</span> <span class="st">"outside"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:enavemap"></span>
<img src="13-ensembleprediction_files/figure-html/enavemap-1.png" alt="Land classification in Rondonia using the average of the probabilities produced by Random Forest and SVM algorithms (source: authors)." width="100%"><p class="caption">
Figure 112: Land classification in Rondonia using the average of the probabilities produced by Random Forest and SVM algorithms (source: authors).
</p>
</div>
<p>We can also consider the class areas produced by the ensemble combination and compare them to the original estimates.</p>
<div class="sourceCode" id="cb238"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the summary of the map produced by LTAE</span></span>
<span><span class="va">sum4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ro_cube_20LMR_average_class</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="st">"class"</span>, <span class="st">"area_km2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">sum4</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"class"</span>, <span class="st">"ave"</span><span class="op">)</span></span>
<span><span class="co"># compare class areas of non-smoothed and smoothed maps</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">sum1</span>, <span class="va">sum2</span>, by <span class="op">=</span> <span class="st">"class"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">sum3</span>, by <span class="op">=</span> <span class="st">"class"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">sum4</span>, by <span class="op">=</span> <span class="st">"class"</span><span class="op">)</span></span></code></pre></div>
<pre><code>#&gt; # A tibble: 9 × 5
#&gt;   class                     rfor   tcnn    ltae     ave
#&gt;   &lt;chr&gt;                    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
#&gt; 1 Clear_Cut_Bare_Soil    80       68     68      71    
#&gt; 2 Clear_Cut_Burned_Area   1.7      4.7    4.8     3.8  
#&gt; 3 Clear_Cut_Vegetation   19       14     14      15    
#&gt; 4 Forest                280      240    240     250    
#&gt; 5 Mountainside_Forest     0.0088   0.04   0.028   0.036
#&gt; 6 Riparian_Forest        47       40     40      45    
#&gt; 7 Seasonally_Flooded     70      130    130     110    
#&gt; 8 Water                  63       67     66      68    
#&gt; 9 Wetland                14       13     13      11</code></pre>
<p>As expected, the ensemble map combines information from the three models. Taking the RF model prediction as a base, there is a reduction in the areas of classes <code>Clear_Cut_Bare_Soil</code> and <code>Forest</code>, confirming the tendency of the RF model to overemphasize the most frequent classes. The LTAE and TempCNN models are more sensitive to class variations and capture time-varying classes such as <code>Riparian_Forest</code> and <code>Clear_Cut_Burned_Area</code> in more detail than the RF model. However, both TempCNN and LTAE tend to confuse the deforestation-related class <code>Clear_Cut_Vegetation</code> and the natural class <code>Riparian_Forest</code> more than the RF model. This effect is evident in the left bank of the Madeira river in the centre-left region of the image. Also, both the LTAE and TempCNN maps are more grainy and have more spatial variability than the RF map.</p>
<p>The average map provides a compromise between RF’s strong empahsis on the most frequent classes and the tendency of deep learning methods to produce outliers based on temporal relationship. The average map is less grainy and more spatially consistent than the LTAE and TempCNN maps, while introducing variability which is not present in the RF map.</p>
<p>This chapter shows the possibilities of ensemble prediction. There are many ways to get better results than those presented here. Increasing the number of spectral bands would improve the final accuracy. Also, Bayesian smoothing for deep learning models should not rely on default parameters; rather it needs to rely on variance analysis, increase the spatial window and provide more informed hyperparameters. In general, ensemble prediction should be consider in all situations where one is not satisfied with the results of individual models. Combining model output increses the reliability of the result and thus shouls be considered in all situations where similar classes are present.</p>

</div>
  <div class="chapter-nav">
<div class="prev"><a href="uncertainty-and-active-learning.html">Uncertainty and active learning</a></div>
<div class="next"><a href="object-based-time-series-image-analysis.html">Object-based time series image analysis</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav"><li><a class="nav-link" href="#ensemble-prediction-from-multiple-models">Ensemble prediction from multiple models</a></li></ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong><strong>sits</strong>: Satellite Image Time Series Analysis on Earth Observation Data Cubes</strong>" was written by Gilberto Camara, Rolf Simoes, Felipe Souza, Felipe Menino, Charlotte Pelletier, Pedro R. Andrade, Karine Ferreira, Gilberto Queiroz. It was last built on 2024-08-26.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
